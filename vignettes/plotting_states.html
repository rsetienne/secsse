<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Thijs Janzen" />

<meta name="date" content="2023-01-20" />

<title>Plotting probabilities</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Plotting probabilities</h1>
<h4 class="author">Thijs Janzen</h4>
<h4 class="date">2023-01-20</h4>



<div id="plotting-ancestral-states" class="section level2">
<h2>Plotting ancestral states</h2>
<p>Here, I want to give you a short (and minimal) demonstration of how
to plot your ancestral states alongside your tree. Let us assume we have
a simple tree, with almost trivial traits:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>phy <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">rphylo</span>(<span class="at">n =</span> <span class="dv">4</span>, <span class="at">birth =</span> <span class="dv">1</span>, <span class="at">death =</span> <span class="dv">0</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>traits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">plot</span>(phy)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAAdVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6OgA6OmY6ZrY6kNtmAABmOgBmkNtmtttmtv+QOgCQkGaQ2/+2ZgC2Zjq2Zma2kGa2kJC229u22/+2///bkDrbkGbbtmbbtpDb/9vb////tmb/25D/27b//7b//9v///+UGjI2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHo0lEQVR4nO3Y23Ii1xmA0daBSSwciwiPEw05CAZ4/0c0CMlJblLl/iyNpvZaVTPN1U+r+Grv3T0dIZi+9Q3wfRMQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIa2OHz4/H4z8V09Zf5MwQ0sM3N03E7/XT8urybPUNAA1vfHg+r29OHzfWXuTMENKz9cppu/v23h9PH7fcS0MQHsvv0cPlZDqvTXjb3J/2j2viA38b/99u6s7l6mD1EQOPaXNadw89X9/OHCGhc6/P5+bR/hfVHQAPbPz+8739M/QhoXLvF/bmi68c0RUDD2p6XnnVbfwQ0sP1quju/CzqZ/xpIQDQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASN76J53+1xt/G+/uzQN612/j3QmIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREADO3x+fL5ub55mzxDQwDaXcHaLu/kzBDSw9e35/91iup8/Q0DD2i+n6ebp8MviT1cP86eMHNA0uN2nUzj/+PPfN+EINHZA3/oGvrHt9Zfn62Unm0lA43pZeQ6rcIYW0MBeVp7dIpyhBTSu/fKy8rzuZPMIaFivK086QwtoXNvL0/thVc7QAhrXfjWd97DXnWwmAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEjeOaCP5Y3/9iG8b0Afy0e+t++GgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhHQwA6fH4/Hrz9O0w9Ps2cIaGCbm6fjbnF3/Lq8nT1DQANbn7pZnyI6bq+/zJ0hoGHtl9N0c9m7NgKa4yPf23vYfXq4fPjXaRuba+iABveycW2naX4/Qwc0us3LBnZYXz3MHiKgca1fn732S1sYv9t/shEQM+wW98///us0PYOAhrU9n3zWN4/P7xJnE9Cw9qvT09fh58V09VOYIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBDSww+fHy3V1O3uGgAa2uXl6vq6nu9kzBDSw9WXh2UzT/ewZAhrWfjlN5yVoe/XXq4fZUwQ0rt2ncze7xf3rVjbHmwfEh7W9/nJeh+7KGdoKMbDzwnOO59TQ/CECGtf5DL0+RXTZymYS0LDOC8/5IH32cd8D8WGdTs+XD+twhhbQuLYvD+/pDC2gce1XlxfQ++X814gCIhIQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREImASAREIiASAZEIiERAJAIiERCJgEgERCIgEgGRCIhEQCQCIhEQiYBIBEQiIBIBkQiIREAkAiIREMmv1wobMHycwPQAAAAASUVORK5CYII=" /><!-- --></p>
<p>A typical likelihood calculation would look like (assuming 2 observed
and 2 hidden traits):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>params <span class="ot">&lt;-</span> secsse<span class="sc">::</span><span class="fu">id_paramPos</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">2</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>params[[<span class="dv">1</span>]][] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>params[[<span class="dv">2</span>]][] <span class="ot">&lt;-</span> <span class="fl">0.0</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>params[[<span class="dv">3</span>]][, ] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">diag</span>(params[[<span class="dv">3</span>]]) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>ll <span class="ot">&lt;-</span> secsse<span class="sc">::</span><span class="fu">secsse_loglik</span>(<span class="at">parameter =</span> params,</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>                             <span class="at">phy =</span> phy,</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>                             <span class="at">traits =</span> traits,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>                             <span class="at">num_concealed_states =</span> <span class="dv">2</span>,</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>                             <span class="at">see_ancestral_states =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>                             <span class="at">sampling_fraction =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>ll</span></code></pre></div>
<pre><code>## $ancestral_states
##        [,1]      [,2]       [,3]       [,4]
## 7 0.4243298 0.4297629 0.07433059 0.07157672
## 6 0.1027372 0.6574616 0.03145469 0.20834647
## 5 0.3253326 0.3253326 0.17466736 0.17466736
## 
## $LL
## [1] -8.605749
## 
## $states
##      [,1] [,2] [,3] [,4]      [,5]      [,6]       [,7]       [,8]
## [1,]    0    0    0    0 1.0000000 0.0000000 1.00000000 0.00000000
## [2,]    0    0    0    0 0.0000000 1.0000000 0.00000000 1.00000000
## [3,]    0    0    0    0 0.0000000 1.0000000 0.00000000 1.00000000
## [4,]    0    0    0    0 1.0000000 0.0000000 1.00000000 0.00000000
## [5,]    0    0    0    0 0.4243298 0.4297629 0.07433059 0.07157672
## [6,]    0    0    0    0 0.1027372 0.6574616 0.03145469 0.20834647
## [7,]    0    0    0    0 0.3253326 0.3253326 0.17466736 0.17466736</code></pre>
<p>If we want to visualize the change in trait probabilities across the
tree, we can use the function ‘plot_state_exact’. To use this function,
we need to provide a helper function that can translate the posterior
probabilities into a single probability of interest. For instance, for 2
observed and 2 hidden traits, we observe the following states
reconstructed along the nodes:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>ll<span class="sc">$</span>states</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]      [,5]      [,6]       [,7]       [,8]
## [1,]    0    0    0    0 1.0000000 0.0000000 1.00000000 0.00000000
## [2,]    0    0    0    0 0.0000000 1.0000000 0.00000000 1.00000000
## [3,]    0    0    0    0 0.0000000 1.0000000 0.00000000 1.00000000
## [4,]    0    0    0    0 1.0000000 0.0000000 1.00000000 0.00000000
## [5,]    0    0    0    0 0.4243298 0.4297629 0.07433059 0.07157672
## [6,]    0    0    0    0 0.1027372 0.6574616 0.03145469 0.20834647
## [7,]    0    0    0    0 0.3253326 0.3253326 0.17466736 0.17466736</code></pre>
<p>Here, the first four rows indicate the tip states, whilst the later
three rows indicate the states at the internal nodes (with the last row
indicating the root, in this case). The columns indicate the four
extinction and four speciation rates, following the order in params[[1]]
and params[[2]]. Thus, we have for both, rates 0A, 1A, 0B and 1B. If we
are interested in the posterior probability of trait 0, we have to
provide a helper function that sums the probabilities of 0A and 0B,
e.g.:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>helper_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(x[<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>)]) <span class="sc">/</span> <span class="fu">sum</span>(x)) <span class="co"># normalized by total sum, just in case.</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>}</span></code></pre></div>
<p>We can now use this to plot this probability across the tree. There
are two options for plotting: using the evaluations along the branches
as used by the integration method, or evaluating the branch values at a
specific number of intervals. Using the explicit evaluations is more
precies, but might be memory heavy. Usually, using 10-100 evaluations
per branch provides a very accurate approximation:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>secsse<span class="sc">::</span><span class="fu">plot_state_exact</span>(<span class="at">parameters =</span> params,</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                 <span class="at">phy =</span> phy,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                 <span class="at">traits =</span> traits,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                 <span class="at">num_concealed_states =</span> <span class="dv">2</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                 <span class="at">sampling_fraction =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                 <span class="at">prob_func =</span> helper_function)</span></code></pre></div>
<pre><code>## Warning: Removed 6 rows containing missing values (`geom_segment()`).</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAC1lBMVEUAAAAAADoAAGYAOpAAZrYTK0MTK0QTLEQULEQULEUULUUULUYULkcVLkcVLkgVL0gVL0kVMEkVMEoWMEoWMUoWMUsWMUwWMkwXMkwXMk0XM00XM04XNE8YNE8YNFAYNVAYNVEYNlEYNlIZNlIZN1MZN1QZOFQaOFQaOFUaOVUaOVYaOVcaOlcbOlcbOlgbO1gbO1kcPVsdPlwdP10eQF8eQWAfQmIfQ2QgRGUgRWYhRmghR2kiSWsiSmwjS24kTG8kTXElTnIlT3QmUHUmUXYnUngoVHooVXspVn0pV38qWIAqWYIrWoMsXIUsXYYtXoctX4kuYIouYYwvY44wZI8wZZExZpIxZ5QyaZYyaZczMzMzapgza5k0bJo0bZw1bp41b582caE3cqM3c6Q4dKY4dac5d6k6AAA6ADo6AGY6OpA6eKs6eaw6kNs7eq47e688fbE9frM9f7Q+gLY+gbc/g7lAhLtAhbxBhr5Bh79CicFDisNDi8REjcZFjshFj8lGkMtGkc1Hk89IlNBIldJJl9RJmNVKmddLm9lLm9pMndxMnd1Mnt1NTU1NTW5NTY5NbqtNjshNnt1Nnt5Nn95Nn99NoOBOoOBOoOFOoeFOoeJOouJOouNPouNPo+RPo+VPpOVQpOZQpeZQpedQpehQpuhRpuhRpulRp+lRp+pRqOpRqOtSqOtSqOxSqexSqe1Squ1Tqu5Tq+5Tq+9Tq/BTrPBUrPBUrPFUrfFUrfJUrvJUrvNVrvNVrvRVr/RVr/VVsPVVsPZWsPZWsfZWsfdmAABmADpmAGZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQOmaQkDqQkGaQtpCQ2/+rbk2rbm6rjk2r5OSr5P+2ZgC2///Ijk3I///bkDrb///kq27k////tmb/yI7/25D/5Kv//7b//8j//9v//+T///9mLbTYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANvElEQVR4nO3dh59sZX3H8QURsWtE7IUYE2OKpPdieu9V0huShPTemykmN4kmJjFNQFFBUARERUEpJtcUNAmkQRIuUrzcS9n/IHN2n9k5M/vAax++9yzLfd7v10tn7p7ld2bmfu6ZM7N7zqytQ2Dtgb4BPLgJiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIhIHNApL9j0scXHjHx08VEzz6/4yJnnrfiImQ8vnlt8WMVzVnzozMkzz17xrJFnzjxj5OnF0yqeOvOUkSfPPGnkpJknrjhx5gkjHzLz+OJxxWNXPGbm0cWjikeueETx8OKEmYeNPHTkSETRIg/oSNwKHrQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARARE5H4EdOopS478beJB5P4EtPQnAfVNQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQESOtoBOPfPMs8bOPvvVK17zmnOK1w5eV7x+07lj55133hsG52+54IIL3jj2pk0XFm/ectFFF1287JJLLnlLcemlby3etuntC5dd9o7BO4vLL7/8irF3Dd696corr7yquPrqa4rdfsCPuoAe6BvQGwERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERBLDr34hqbvFxBLBEREQOzUoRf/19raQ25bP3T6f64de/Pd16+tHbf44k4JqF+HThuyOW52OQtnuLL5h4fcNlzulID6dei0/RtPWRuXB4+9eeP/5l/c6RAB9Wsjkzvfs3/j8uDwtDXUdPrNG1/c6RAB9UtAFQLauc1nq9Nv3gzomBs2n8KGP3gKYwe2dqKHXOxEbxLQzm28Yj9uvr0Zv4zfeT8C6ljre4ZVAuqXgCoEtHMCqhDQLhMQEQFxrzbeVFwf3lfc+PFquVgmIO7NwbVjNwK6+/r967ceN79YISDuxYFj/ntzC3Tn3988bIzKxcp3Cahv1yxZWVhyOfSDt63f+Xc3lIuV7xFQv66qW3xDCWj4OeusnHKxMkRA/bqibvENtkDcl8vqFt9wyD4Q9+HSusU3lFzuvv6MzVdhZ3gVxsjFdYtvGAIa/ud9IGourGsbIqB+nV/XNkRA/Tq3rm2IgPp1Tl3bEAH166y6tiEC6ter6tqGCKhff13XNkRA/XplXdsQAfXrFXVtQwTUr5fXtQ0RUL9eWtc2RED9+r26tiEC6tfv1rUNEVC/fqeubYiA+vXbdW1DBNSvl9S1DRFQv36rrm2IgPr1m3VtQwTUr9+oaxsioH79et188davQN+6Nti/cXmsozKY+7W6snT5UPjhqMIDtVO3Cqhfv1pXli4dBjYcUHj3v9fORyWgvv3KkvGSpQNRh03R7ClteCJbIaB+/XJdWTo+FH7jcjgj3vatkID69Ut1Zel4C3Rw64DCbftBAurXL9aVpeN9oANnzP8bAbHlF+rK0tGh8JtPXMNm6O7/8DKeuZ+vmy/efB9o49j4zWeyW9fWjtn2QkxA/fq5urYhAurXz9a1DRFQv36mrm2IgPr103VtQwTUr5+qaxsioH79ZF3bEAH16yfq2oYIqF8/Xtc2RED9+rG6tiEC6teP1rUNEVC/fqSubYiA+vXDdW1D4oBO3WPa70+3fqiubUgc0B6zp2/cHvMDdW1DBNSv769rGyKgfn1fXdsQAfXre+vahgioX99T1zZEQP367rq2IQLq13fVtQ0RUL++s26+ePH5cuWsCtN84Nwes6dv3B7zHXVl6ejkCpsHgy2fbWFOQP369rqydHFgYTmeeaIP3d1j9vSN24O+bcl4yeLQ5nJWhYk+9nuP2dM3bo/51rqydHFyhXJWhfHZFhYE1K9vqStLVzY4B/bbArHsm+vK0pVdngP77QOx7JvqytLFyRXKWRVGZ1sYEVC/vrFuvnhxcoVyVgXvA7HkG+rahgioX19f1zZEQP36urq2IQLq19fWtQ0RUL++pq5tiID69dV1bUME1K+vqmsbIqB+fWVd2xAB9esr6tqGCKhfX17XNkRA/fqyurYhAurXl9a1DRFQv76krm2IgPr1xXVtQwTUry+qaxsioH59YV3bEAH16wvq2oYIqF+fX9c2RED9+ry6tiEC6tcL69qGCKhfn1s3X7z4HfpDp2183nc5x8IyAfXrc+rK0sW5FIajCYejU7d94O5AQP367LqydHEc4cEhowP7t39m/EBAffusJeMly0cyz66VcyysEFC/PrOuLF06l8JwVGo5x8LKEAH16zPqytLxFujO95xRvrptP0hA/fr0urJ0dC6FQ6dtZSMgtnxaXVm6OJdC6aecY2FliID69al188VbJ1cY3v8Zdp/LORaWCahfn1LXNkRA/frkurYhAurXJ9W1DRFQvz6xrm2IgPr1CXVtQwTUr4+vaxsioH59XF3bEAH165S6tiEC6tcL6tqGCKhfz69rGyKgfj2vrm2IgPr13Lq2IQLq13Pq2oYIqF/PrmsbIqB+PaOubYiA+vW0urYhAurXU+rahgioX0+saxsioH49oa5tiID69di6+eLFsfHlmg+cY8mj6srSxbHx5driC2MC6tcj68rSxXFh5ZoP3WW7hy0ZL1kcmVqu+dhvWiyOjS/Xlg6W3yIg6myBiNgHIrI4Nr5cW3xhTEDci61j470PxHQERERARAREREBEjraATj755KVf8H3WyDOLxW9vPr3Y/mt5Ty0Wv2f15MGTtpx00knbf5XmxBNPXPndiMcXj9uy9JPvxwwevWX+88yVn049onj4lhNOOGHxA4jjjz/+oVt2+wE/2gJilwmIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIyP0I6KUzv1/8wdzLZ/5k5E9nXrHqz4o/L/5i7pUjfznyV4O/WfG3q141c2Zx1tjZM69ecc7ca4vXzbx+5Ny582beMHP+yBvH3lRcWLx57OIVb5m7dOatxduKt89dNvOOmXcWl89cMfaumXcXVxVXD64pjnwi9+1+BAQLAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIvcd0FrNi6pfPeKOrtU8sHfnAQuo6kVH/lYc/as52u7OFgHtzmqOtruzRUC7s5qj7e5ssRNNREBEBEREQEQERKQhoLvet++PP7hybQKL4Yffu2/fddOvZn39nhsnW81oPffcuO8Pb5p+NbNH7Y9umWo12+08oOFRvv1ly9cmsBh+1/tvWj/8DxM95Ev34fbpOh2t5wPXrd8x1b+75Uft9un+eW+z84Du+pdb1g//4y1L1yawGH7Hy9Y3HvWJVzP7N/tP/zrdhm7pUZvMYjWH//mD065qxc4D2rhl779p6doElofvxmru+Z//m+4pbPyo/e90T2GL1ezdLdCw+d28jYtrE1gafs+N106zlvFqbr92wn2gxXoOv/e6jb/niVcz7Q7qdnt6C3TX+6bqZ/neTBjQrj9qw17jHbu4F72H94E2/s1OZbGa2/cNpip19Kj924QBjfYcp3x6qGh5FXbt1quwa6d8FTYfPmU/y/dhwi3QaD0fmPApbPSo7dktUHlyHTrfhfeBZqvZ3DRM9Ve7uDe78T5QedSm+4tdrOaOfRO+3bSdd6KJCIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIj8P1MtiOt5FwncAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>secsse<span class="sc">::</span><span class="fu">plot_state_exact</span>(<span class="at">parameters =</span> params,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                 <span class="at">phy =</span> phy,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                 <span class="at">traits =</span> traits,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                 <span class="at">num_concealed_states =</span> <span class="dv">2</span>,</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                 <span class="at">sampling_fraction =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                 <span class="at">num_steps =</span> <span class="dv">10</span>,</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>                 <span class="at">prob_func =</span> helper_function)</span></code></pre></div>
<pre><code>## Warning: Removed 6 rows containing missing values (`geom_segment()`).</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAACW1BMVEUAAAAAADoAAGYAOpAAZrYTK0MTLEQULEUULUUULUYULkcVLkgVL0gVL0kWMEoWMUoWMUsWMkwXMk0XM00XM04XNE8YNE8YNVAYNVEZNlIZN1MZN1QaOFUaOVYaOVcbO1gbO1kcPVsdPlwdP10eQF8eQWAfQmIfQ2QgRGUgRWYhRmghR2kiSWsiSmwjS24kTG8kTXElTnIlT3QmUHUmUXYnUngoVHooVXspVn0pV38qWIAqWYIrWoMsXIUsXYYtXoctX4kuYIouYYwvY44wZI8wZZExZpIxZ5QyaZYyaZczMzMzapgza5k0bJo0bZw1bp41b582caE3cqM3c6Q4dKY4dac5d6k6AAA6ADo6AGY6OpA6eKs6eaw6kNs7eq47e688fbE9frM9f7Q+gLY+gbc/g7lAhLtAhbxBhr5Bh79CicFDisNDi8REjcZFjshFj8lGkMtGkc1Hk89IlNBIldJJl9RJmNVKmddLm9lLm9pMndxNTU1NTW5NTY5NbqtNjshNnt1Nn95Nn99OoOFOoeFOouNPouNPo+VQpOZQpedQpuhRpuhRpulRp+pSqOtSqexSqu1Tqu5Tq+9UrPBUrPFUrfFUrvJVrvNVr/RVsPVWsPZWsfdmAABmADpmAGZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQOmaQkDqQkGaQtpCQ2/+rbk2rbm6rjk2r5OSr5P+2ZgC2///Ijk3I///bkDrb///kq27k////tmb/yI7/25D/5Kv//7b//8j//9v//+T///+xdBdfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMlElEQVR4nO3diZ8caV3H8dkl3IiCCKgIiwcICCKCiqKAIiqrgnIsKwS8D+RSAZWo3IogIJ4oaFAIoLtcu+Ame4Rkcs2fZaqnZqpr5um86sk3Nds7z/v9eu12Z6r3V92dT6qrO1vVG1sQ2Li37wD3bQIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIhIHdMPjp3ncRN8x0WMnetREj5jo4RM9bKIHTXT/ia5FFDXygK7FveA+S0BEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQESuIqAbbxi59veJ+5CrCWj0KwG1TUBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEDltAN/7tKn+30kdW+dhKH1/pH1b555X+daV/W+WTKx30E37oArq370BrBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQIxsvvq2qtsLiBEBEREQU22++isbG/e7Z2vz5i9vXH/q4q0bG0eGH04loHZt3tRlc+Ty5eVwuivbv7jfPd3lVAJq1+ZNxxcvWYvLM9efWvxr54dThwioXYtMzn/q+OLyTPey1dV086nFD6cOEVC7BFQgoOm2X61uPrUd0HW3bb+Edb/wEsYEuzvRXS52orcJaLrFO/YjO9ub5bfx0/sRUMNqPzMsElC7BFQgoOkEVCCgAyYgIgJipcWHilvd54qLv17tL8YExCpnNq5fBHTx1uNbdx/ZudhDQKxw8rqvbm+Bzv/nqW5j1F/suZWA2nbF05v1uWz+2j1b5//jtv5iz20E1K5/Lxtu0AfU/T3r5XL6iz1DBNSuT5QNN7AF4kr+pWy4waZ9IK7gH8uGG/S5XLz16Pa7sKPehbFkxfmIhxt0AXX/+ByIkr8vqxsioHZ9tKxuiIDateL8/HVDBNSuD5XVDRFQuz5YVjdEQO36m7K6IQJq1wfK6oYIqF3vL6sbIqB2vbesboiA2vXusrohAmrXO8vqhgioXX9eVjdEQO36s7K6IQJq15+W1Q0RULveUVY3REDtentZ3RABtettZXVDBNSuPymrGyKgdv1xWd0QAbXrj8p2Fu/+L9B3b3SOLy6vd1QGO95a1i8dHwrfHVV4snTqVgG16y1l/dLRYWDdAYUXv1g6H5WA2vbmkeUlowNRu03R5Ze07oVsDwG1601l/dLlQ+EXl90Z8fZvhQTUrjeW9UuXt0Bndg8o3LcfJKB2/WFZv3R5H+jk0Z3/RkDsekNZv3TpUPjtF65uM3TxS97Gs+MPynYWb38OtDg2fvuV7O6Njev2vRETULt+v6xuiIDa9XtldUME1K7fLasbIqB2/U5Z3RABteu3y+qGCKhdv1VWN0RA7frNsrohAmrXb5TVDRFQu369rG6IgNr1+rK6IQJq1+vK6oYIqF2vLasbEgd045qpfzzNek1Z3ZA4oDWz1nduzbyqrG6IgNr1yrK6IQJq1yvK6oYIqF0vL6sbIqB2/WpZ3RABtetXyuqGCKhdLyurGyKgdr20bGfx8P1y/VkV5vnCuTWz1nduzfxyWb906eQK2weDjc+2sENA7fqlsn7pcGBhfzzzTF+6u2bW+s6toV8cWV4yHNrcn1Vhpq/9XjNrfefWzC+U9UuHkyv0Z1VYPtvCQEDt+vmyfumeDc7J47ZAjP1cWb90zy7PyeP2gRh7cVm/dDi5Qn9WhaWzLSwRULt+tmxn8XByhf6sCj4HYuRFZXVDBNSunymrGyKgdv10Wd0QAbXrhWV1QwTUrheU1Q0RULueX1Y3REDt+qmyuiECatdPltUNEVC7nldWN0RA7fqJsrohAmrXj5fVDRFQu55bVjdEQO36sbK6IQJq14+W1Q0RULt+pKxuiIDa9ZyyuiECatezy+qGCKhdP1xWN0RA7XpWWd0QAbXrh8rqhgioXc8s21k8/D/0mzctvu+7P8fCmIDa9YNl/dLhXArd0YTd0an7vnC3I6B2PaOsXzocR3imy+jk8f3fGd8RUNuePrK8ZHwk8+Vr/TkW9hBQu36grF86OpdCd1Rqf46FPUME1K6nlfVLl7dA5z91tP/pvv0gAbXrqWX90qVzKWzetJuNgNj1lLJ+6XAuhb6f/hwLe4YIqF3fX7azePfkCt3nP93uc3+OhTEBtevJZXVDBNSuJ5XVDRFQu76vrG6IgNr1vWV1QwTUru8pqxsioHZ9d1ndEAG164lldUME1K4byuqGCKhdTyirGyKgdn1XWd0QAbXrcWV1QwTUru8sqxsioHZ9e1ndEAG167FldUME1K5Hl9UNEVC7HlVWN0RA7XpkWd0QAbXrW8rqhgioXQ8vqxsioHY9rGxn8XBsfH/NF84x8pCyfulwbHx/bfjBMgG168Fl/dLhuLD+mi/dZb8HjCwvGY5M7a/52m9qDMfG99dGB8vvEhBltkBE7AMRGY6N768NP1gmIFbYPTbe50DMR0BEBEREQEQEROSwBfSYlb5tpW9d5RErffNK37TKQ1da8XdSlz1wlfuvdNBP+GELiAMmICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICJXEdB7pnrfZH891Qen+vBkH53q45P901SfmOyTU137RK7sKgKCgYCICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiMiVA9ooeUnxp9fc4VrNvftw7rWAil5y7e/F4V/NYXs4uwR0MKs5bA9nl4AOZjWH7eHsshNNREBEBEREQEQERKQioAufO/ZX39hzbQbD8HOfPnbslvlXs7V16fbZVrO0nku3H/uLO+ZfzeVn7S/vmms1+00PqHuWT79rfG0Gw/ALn79j69x/zfSUjx7D6fk6XVrPnbdsnZ3rz934WTs93x/vfaYHdOELd22d+++7RtdmMAw/2z0hd870W7v8GM595n/m29CNnrXZDKs599lvzLuqPaYHtLhnn79jdG0G4+EHsZpLX/u/+V7Clp+1r8/3EjasZn23QN3md/s+DtdmMBp+6fYT86xleTWnT8y4DzSs59ynb1n8Ps+8mnl3UPdb6y3Qhc/N1c/40cwY0IE/a91e49kD3Ite432gxZ/ZuQyrOX2sM1epS8/a/84Y0NKe45wvDwU178JO7L4LOzHnu7Cd4XP2M34MM26BltZz54wvYUvP2tpugfoX167zA/gc6PJqtjcNc/3WDo/mID4H6p+1+X5jh9WcPTbjx037+SSaiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIjI/wOIuCg702YWdAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>secsse<span class="sc">::</span><span class="fu">plot_state_exact</span>(<span class="at">parameters =</span> params,</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>                 <span class="at">phy =</span> phy,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>                 <span class="at">traits =</span> traits,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>                 <span class="at">num_concealed_states =</span> <span class="dv">2</span>,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>                 <span class="at">sampling_fraction =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>                 <span class="at">num_steps =</span> <span class="dv">100</span>,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>                 <span class="at">prob_func =</span> helper_function)</span></code></pre></div>
<pre><code>## Warning: Removed 6 rows containing missing values (`geom_segment()`).</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAC1lBMVEUAAAAAADoAAGYAOpAAZrYTK0MTK0QTLEQULEQULEUULUUULUYULkcVLkcVLkgVL0gVL0kVMEkVMEoWMEoWMUoWMUsWMUwWMkwXMkwXMk0XM00XM04XNE8YNE8YNFAYNVAYNVEYNlEYNlIZNlIZN1MZN1QZOFQaOFQaOFUaOVUaOVYaOVcaOlcbOlcbOlgbO1gbO1kcPVsdPlwdP10eQF8eQWAfQmIfQ2QgRGUgRWYhRmghR2kiSWsiSmwjS24kTG8kTXElTnIlT3QmUHUmUXYnUngoVHooVXspVn0pV38qWIAqWYIrWoMsXIUsXYYtXoctX4kuYIouYYwvY44wZI8wZZExZpIxZ5QyaZYyaZczMzMzapgza5k0bJo0bZw1bp41b582caE3cqM3c6Q4dKY4dac5d6k6AAA6ADo6AGY6OpA6eKs6eaw6kNs7eq47e688fbE9frM9f7Q+gLY+gbc/g7lAhLtAhbxBhr5Bh79CicFDisNDi8REjcZFjshFj8lGkMtGkc1Hk89IlNBIldJJl9RJmNVKmddLm9lLm9pMndxMnd1Mnt1NTU1NTW5NTY5NbqtNjshNnt1Nnt5Nn95Nn99NoOBOoOBOoOFOoeFOoeJOouJOouNPouNPo+RPo+VPpOVQpOZQpeZQpedQpehQpuhRpuhRpulRp+lRp+pRqOpRqOtSqOtSqOxSqexSqe1Squ1Tqu5Tq+5Tq+9Tq/BTrPBUrPBUrPFUrfFUrfJUrvJUrvNVrvNVrvRVr/RVr/VVsPVVsPZWsPZWsfZWsfdmAABmADpmAGZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQOmaQkDqQkGaQtpCQ2/+rbk2rbm6rjk2r5OSr5P+2ZgC2///Ijk3I///bkDrb///kq27k////tmb/yI7/25D/5Kv//7b//8j//9v//+T///9mLbTYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANvElEQVR4nO3dh59sZX3H8QURsWtE7IUYE2OKpPdieu9V0huShPTemykmN4kmJjFNQFFBUARERUEpJtcUNAmkQRIuUrzcS9n/IHN2n9k5M/vAax++9yzLfd7v10tn7p7ld2bmfu6ZM7N7zqytQ2Dtgb4BPLgJiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIhIHNApL9j0scXHjHx08VEzz6/4yJnnrfiImQ8vnlt8WMVzVnzozMkzz17xrJFnzjxj5OnF0yqeOvOUkSfPPGnkpJknrjhx5gkjHzLz+OJxxWNXPGbm0cWjikeueETx8OKEmYeNPHTkSETRIg/oSNwKHrQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARARE5H4EdOopS478beJB5P4EtPQnAfVNQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERARAREREBEBEREQESOtoBOPfPMs8bOPvvVK17zmnOK1w5eV7x+07lj55133hsG52+54IIL3jj2pk0XFm/ectFFF1287JJLLnlLcemlby3etuntC5dd9o7BO4vLL7/8irF3Dd696corr7yquPrqa4rdfsCPuoAe6BvQGwERERARAREREBEBEREQEQERERARAREREBEBEREQEQERERBLDr34hqbvFxBLBEREQOzUoRf/19raQ25bP3T6f64de/Pd16+tHbf44k4JqF+HThuyOW52OQtnuLL5h4fcNlzulID6dei0/RtPWRuXB4+9eeP/5l/c6RAB9Wsjkzvfs3/j8uDwtDXUdPrNG1/c6RAB9UtAFQLauc1nq9Nv3gzomBs2n8KGP3gKYwe2dqKHXOxEbxLQzm28Yj9uvr0Zv4zfeT8C6ljre4ZVAuqXgCoEtHMCqhDQLhMQEQFxrzbeVFwf3lfc+PFquVgmIO7NwbVjNwK6+/r967ceN79YISDuxYFj/ntzC3Tn3988bIzKxcp3Cahv1yxZWVhyOfSDt63f+Xc3lIuV7xFQv66qW3xDCWj4OeusnHKxMkRA/bqibvENtkDcl8vqFt9wyD4Q9+HSusU3lFzuvv6MzVdhZ3gVxsjFdYtvGAIa/ud9IGourGsbIqB+nV/XNkRA/Tq3rm2IgPp1Tl3bEAH166y6tiEC6ter6tqGCKhff13XNkRA/XplXdsQAfXrFXVtQwTUr5fXtQ0RUL9eWtc2RED9+r26tiEC6tfv1rUNEVC/fqeubYiA+vXbdW1DBNSvl9S1DRFQv36rrm2IgPr1m3VtQwTUr9+oaxsioH79et188davQN+6Nti/cXmsozKY+7W6snT5UPjhqMIDtVO3Cqhfv1pXli4dBjYcUHj3v9fORyWgvv3KkvGSpQNRh03R7ClteCJbIaB+/XJdWTo+FH7jcjgj3vatkID69Ut1Zel4C3Rw64DCbftBAurXL9aVpeN9oANnzP8bAbHlF+rK0tGh8JtPXMNm6O7/8DKeuZ+vmy/efB9o49j4zWeyW9fWjtn2QkxA/fq5urYhAurXz9a1DRFQv36mrm2IgPr103VtQwTUr5+qaxsioH79ZF3bEAH16yfq2oYIqF8/Xtc2RED9+rG6tiEC6teP1rUNEVC/fqSubYiA+vXDdW1D4oBO3WPa70+3fqiubUgc0B6zp2/cHvMDdW1DBNSv769rGyKgfn1fXdsQAfXre+vahgioX99T1zZEQP367rq2IQLq13fVtQ0RUL++s26+ePH5cuWsCtN84Nwes6dv3B7zHXVl6ejkCpsHgy2fbWFOQP369rqydHFgYTmeeaIP3d1j9vSN24O+bcl4yeLQ5nJWhYk+9nuP2dM3bo/51rqydHFyhXJWhfHZFhYE1K9vqStLVzY4B/bbArHsm+vK0pVdngP77QOx7JvqytLFyRXKWRVGZ1sYEVC/vrFuvnhxcoVyVgXvA7HkG+rahgioX19f1zZEQP36urq2IQLq19fWtQ0RUL++pq5tiID69dV1bUME1K+vqmsbIqB+fWVd2xAB9esr6tqGCKhfX17XNkRA/fqyurYhAurXl9a1DRFQv76krm2IgPr1xXVtQwTUry+qaxsioH59YV3bEAH16wvq2oYIqF+fX9c2RED9+ry6tiEC6tcL69qGCKhfn1s3X7z4HfpDp2183nc5x8IyAfXrc+rK0sW5FIajCYejU7d94O5AQP367LqydHEc4cEhowP7t39m/EBAffusJeMly0cyz66VcyysEFC/PrOuLF06l8JwVGo5x8LKEAH16zPqytLxFujO95xRvrptP0hA/fr0urJ0dC6FQ6dtZSMgtnxaXVm6OJdC6aecY2FliID69al188VbJ1cY3v8Zdp/LORaWCahfn1LXNkRA/frkurYhAurXJ9W1DRFQvz6xrm2IgPr1CXVtQwTUr4+vaxsioH59XF3bEAH165S6tiEC6tcL6tqGCKhfz69rGyKgfj2vrm2IgPr13Lq2IQLq13Pq2oYIqF/PrmsbIqB+PaOubYiA+vW0urYhAurXU+rahgioX0+saxsioH49oa5tiID69di6+eLFsfHlmg+cY8mj6srSxbHx5driC2MC6tcj68rSxXFh5ZoP3WW7hy0ZL1kcmVqu+dhvWiyOjS/Xlg6W3yIg6myBiNgHIrI4Nr5cW3xhTEDci61j470PxHQERERARAREREBEjraATj755KVf8H3WyDOLxW9vPr3Y/mt5Ty0Wv2f15MGTtpx00knbf5XmxBNPXPndiMcXj9uy9JPvxwwevWX+88yVn049onj4lhNOOGHxA4jjjz/+oVt2+wE/2gJilwmIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIyP0I6KUzv1/8wdzLZ/5k5E9nXrHqz4o/L/5i7pUjfznyV4O/WfG3q141c2Zx1tjZM69ecc7ca4vXzbx+5Ny582beMHP+yBvH3lRcWLx57OIVb5m7dOatxduKt89dNvOOmXcWl89cMfaumXcXVxVXD64pjnwi9+1+BAQLAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIvcd0FrNi6pfPeKOrtU8sHfnAQuo6kVH/lYc/as52u7OFgHtzmqOtruzRUC7s5qj7e5ssRNNREBEBEREQEQERKQhoLvet++PP7hybQKL4Yffu2/fddOvZn39nhsnW81oPffcuO8Pb5p+NbNH7Y9umWo12+08oOFRvv1ly9cmsBh+1/tvWj/8DxM95Ev34fbpOh2t5wPXrd8x1b+75Uft9un+eW+z84Du+pdb1g//4y1L1yawGH7Hy9Y3HvWJVzP7N/tP/zrdhm7pUZvMYjWH//mD065qxc4D2rhl779p6doElofvxmru+Z//m+4pbPyo/e90T2GL1ezdLdCw+d28jYtrE1gafs+N106zlvFqbr92wn2gxXoOv/e6jb/niVcz7Q7qdnt6C3TX+6bqZ/neTBjQrj9qw17jHbu4F72H94E2/s1OZbGa2/cNpip19Kj924QBjfYcp3x6qGh5FXbt1quwa6d8FTYfPmU/y/dhwi3QaD0fmPApbPSo7dktUHlyHTrfhfeBZqvZ3DRM9Ve7uDe78T5QedSm+4tdrOaOfRO+3bSdd6KJCIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIgIiIiAiAiIiICICIiIgIj8P1MtiOt5FwncAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="using-cla-secsse" class="section level1">
<h1>Using CLA secsse</h1>
<p>For CLA secsse, a similar function is available, which works in the
same way. Borrowing from the example for cla_secsse_loglik, we first
prepare our parameters:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>phylotree <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">rcoal</span>(<span class="dv">12</span>, <span class="at">tip.label =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>traits <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>                 ape<span class="sc">::</span><span class="fu">Ntip</span>(phylotree), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>num_concealed_states <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>sampling_fraction <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>phy <span class="ot">&lt;-</span> phylotree</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co"># the idparlist for a ETD model (dual state inheritance model of evolution)</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co"># would be set like this:</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>idparlist <span class="ot">&lt;-</span> secsse<span class="sc">::</span><span class="fu">cla_id_paramPos</span>(traits, num_concealed_states)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>lambd_and_modeSpe <span class="ot">&lt;-</span> idparlist<span class="sc">$</span>lambdas</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>lambd_and_modeSpe[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>idparlist[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> lambd_and_modeSpe</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>idparlist[[<span class="dv">2</span>]][] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>masterBlock <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="fu">diag</span>(masterBlock) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>idparlist[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="fu">q_doubletrans</span>(traits, masterBlock, <span class="at">diff.conceal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co"># Now, internally, clasecsse sorts the lambda matrices, so they look like</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#  a list with 9 matrices, corresponding to the 9 states</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co"># (0A,1A,2A,0B, etc)</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>parameter <span class="ot">&lt;-</span> idparlist</span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>lambda_and_modeSpe <span class="ot">&lt;-</span> parameter<span class="sc">$</span>lambdas</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>lambda_and_modeSpe[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>)</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>parameter[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">prepare_full_lambdas</span>(traits, num_concealed_states,</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a>lambda_and_modeSpe)</span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a>parameter[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">9</span>)</span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a>masterBlock <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fl">0.07</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="fu">diag</span>(masterBlock) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a>parameter[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="fu">q_doubletrans</span>(traits, masterBlock, <span class="at">diff.conceal =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Here, we have 9 different states (3 observed states, and 3 hidden
states), ordered regularly, e.g.: 0A, 1A, 2A, 0B, 1B, 2B, 0C, 1C, 2C. To
observe the change in state 0, we formulate a helper function, noticing
that the first 9 states are the extinction rates:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>helper_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(x[<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">16</span>)]) <span class="sc">/</span> <span class="fu">sum</span>(x)) <span class="co"># normalized by total sum, just in case</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>}</span></code></pre></div>
<p>And then we use these for plotting:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>secsse<span class="sc">::</span><span class="fu">plot_state_exact</span>(<span class="at">parameters =</span> parameter,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>                         <span class="at">phy =</span> phy,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                         <span class="at">traits =</span> traits,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>                         <span class="at">num_concealed_states =</span> <span class="dv">3</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>                         <span class="at">sampling_fraction =</span> sampling_fraction,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>                         <span class="at">cond =</span> <span class="st">&quot;maddison_cond&quot;</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                         <span class="at">root_state_weight =</span> <span class="st">&quot;maddison_weights&quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>                         <span class="at">is_complete_tree =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>                         <span class="at">prob_func =</span> helper_function,</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>                         <span class="at">num_steps =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 22 rows containing missing values (`geom_segment()`).</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAACUlBMVEUAAAAAADoAAGYAOpAAZrYTK0MTK0QTLEQULEQULEUULUUULUYULkcVLkcVL0gVL0kVMEkWMEoWMUsWMUwXMk0XM04YNE8YNVEZNlIZN1MZN1QaOFUaOVYbO1gbO1kcPVsdPlwdP10eQF8eQWAfQmIfQ2QgRGUgRWYhRmghR2kiSWsiSmwjSm0jS24kTG8kTXElTnIlT3QmUHUmUXYnUngoVHooVXspVn0pV38qWIAqWYIrWoMsXIUsXYYtXoctX4kuYIouYYwvY44wZI8wZZExZpIxZ5QyaZYyaZcyapczMzMzapczapgza5k0bJo0bZw1bp41b582caE3cqM3c6Q4dKY4daY4dac5dqg5d6k6AAA6ADo6AGY6OpA6eKs6eaw6kNs7eq47e688fbE9frM9f7Q+gLY+gbc/g7lAhLtAhbxBhr5Bh79CicFDisNDi8REjcZFjshFj8lGkMtGkc1Hk89IlNBIldJJl9RJmNVKmddLm9lLm9pMndxNTU1NTW5NTY5NbqtNjshNnt1Nn99OoeFOouNPo+VQpOZQpuhRp+pSqOtSqu1Tq+9UrPBUrPFUrfFUrfJUrvJUrvNVrvNVrvRVr/RVr/VVsPVVsPZWsPZWsfZWsfdmAABmADpmAGZmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQOjqQOmaQkDqQkGaQtpCQ2/+rbk2rbm6rbo6r5P+2ZgC2///Ijk3I///bkDrb///kq27k////tmb/yI7/25D/5Kv//7b//8j//9v//+T///9n2LsMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQNElEQVR4nO3dh58bxRmH8cN4Y5saCEkI6b05vffe4NILMZDE6b335vTeG8WYxCkmMWmQYBsIxvX+r9zqRlpJ9449c7/VvCPxfD+fREJ7fmfXPJZ0Z3a1tAIIlrx3APONgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAINlAQBfdK9GFyS5IdX6q85Kdm+rsZGel2pKsSdV7IaexkYD63wvMLQKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgBLsOGdK+qcenOLzD7ZN6+UTD0r/3hBQgh3eO1AxAkpAQHEElICA4ggoAQHFEVACAoojoAQEFEdACQgojoASEFAcASUgoDgCSkBAcQSUgIDiCCgBAcURUAICiiOgBAQUR0AJCCiOgBIQUBwBJSCgOAJKQEBxBJSAgOIIKAEBxRFQAgKKI6AEBBRHQAkIKI6AEhBQHAElIKA4AkpAQHEElICA4ggoAQHFEVACAoojoAQEFEdACQgozj+gi992Gpefxttz7cjW7xEvlAoC6nfcLBBQHAElIKA4AkpAQHEElICA4ggoAQHFEVACAoojoAQEFEdACQgojoASEFAcASUgoDgCSlA+oD1XT7lm4NqB6wZ2d/aMKb2nBJTAIaDiK24UASUgoDgCSkBAcQSUgIDiCCgBAcURUAICiiOgBAQUR0AJCCiOgBIQUBwBJSCgOAJKQEBxBJSAgOIIKAEBxRFQAgKKI6AEBBRHQAkIKI6AEhBQHAElIKA4AkpAQHEElICA4ggoAQHFEVCCX3R+OeZXnd+M+W1n3WkVa67rRM6tIKB0cxBQeQSUjoAMBJSOgAwElI6ADASUjoAMBJSOgAwElI6ADASUjoAMBJSOgAwElI6ADASUjoAMBJSOgAwElI6ADASUjoAMBJSOgAwElI6ADASUjoAMBJSOgAwElI6ADASUjoAMBJSOgAwElI6ADNMflcFnZcQR0FwjIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAioQstbW1si7jHQRKhrH7ny5qyvJ6AKLTuuTUALgIByENA6hQI6cuW/lpbOvGPlyFX/XNp08MRNS0ubuwdTEVCFSgV0RZvN5tXb1XDaO2v/cOYd7W0qAqpQsYD2Dl6yBreHNx0c/N/wwdQhBFShYi9hq5kcu2Hv4PZw+7LV1nTVwcGDqUMIqEIElIOA1in6EnbVwbWAzrh57SWs/QdewuZb6TfRbS68iV4gJb+N3zx8vhn/Nj69HwKqUcn3QCoCqhAB5SCgdQgoBwGt4/l3YbkIqEIElIOA1qkloMEPFVfanysO/no13EwioApVEtDhpU2DgE7ctHfl9s3DmykEVKE6Ajpwxr/XnoGO/eFg+2QUbqa+ioAqVDCgPROmNoZcjrzjjpVjv7853Ex9DQFVqFBAu23dF4SA2r9nXS0n3EwNIaAKFQroalv3BTwDzZfly9YsFwro17buC47wHmiuLK+7M1s/t3VfEHI5cdPOte/CdvJdWNVKB/QzW/cFbUDt//g50HwoHdBPbXlDCKgepQP6iS1vCAHVo3RAP7blDSGgepQO6Ee2vCEEVI/SAf3QljeEgOpROqAf2PKGEFA9Sgf0fVveEAKqR+mAvmfLG0JA9Sgd0HdteUMIqB6lA/qOLW8IAdWjdEBft+UNIaB6lA7oa7a8IQRUj9IBfdWWN4SA6lE6oK/Y8oYQUD1KB/RlW94QAqpH6YC+ZMsbQkD1KB3QF215QwioHqUD+oItbwgB1WPUze8Gxs+UuGbg2jHjJ+Kc4tSuU/m8LW+nCagepU9I/ZxtuHn0n0DfvtTaO7jdxFkZ9Sod0GdtYevkqfDtWYUHrEu3ElA9Sgf0GVvYOnEaWHtC4Ym/W9ejIqB6eFxT4dMTxrdMnIjaPhWtvqS1L2RTCKgepQP6lC1sHT8VfnDbXhFv/bMQAdWjdECftIWt489Ah0cnFK57H0RA9Sgd0CdsYev4e6ADO4e/hoAqVjqgj9vC1rFT4ddeuNqnoRP/4Nv4epUO6GO24ea1nwMNzo1feyW7fWnpjHXfiBFQPUoH9FFb3pANBHRJcL88F8fk78GCKh3QR2x5QzYQUM8IaKh0QB+25Q0hoHqUDuhDtrwhBFSP0gF90JY3hIDqUTqgD9jyhhBQPUoH9H5b3hACqkfpgN5nyxtCQPUoHdB7bXlDCKgepQN6jy1vCAHVo3RA77blDSGgepQO6F22vCEE5Gz7cqfw0u+05Q0hIGfbu7ulA9phyxtCQM4cA7rcljeEgJw5BvRWW94QAnLmGNBbbHlDCMiZY0BvtuUNISBnjgG9yZY3hICcOQb0RlveEAJy5hjQG2zDzd3ny4WrKvT1gXM9I6Ch0gG93ha2jl1cYe1ksMmrLQwRkDPHgF5nC1u7EwvD+cy9fehuzwhoyOPiCq+dML6lO7U5XFWht4/97hkBDZUO6NW2sLW7uEK4qsL41RY6BOTMMaBX2cLWqSecA3t5BqqSY0CvtIWtU295DuzlPVCVHAN6hS1s7S6uEK6qMHa1hTEE5MwxoJfbhpu7iyuEqyrwc6AaOQb0MlveEAJy5hjQS215QwjImWNAL7HlDSEgZ44BvdiWN4SAnDkG9CJb3hACcqYHtNyMy/iFL7TlrU5AznoIaKNLv8CWN4SAnDkG9Hxb3hACcuYY0PNseUMIyJljQM+15Q0hIGeOAT3HljeEgJw5BvRsW94QAnLmGNCzbHlDCMiZY0DPtOUNISBnjgE9w5Y3hICcOQb0dFveEAJy5hjQ02x5QwjImWNAT7XlDSEgZ44BPcWWN4SAnDkG9GRb3hACcuYY0JNsw83df0N/5IrB532HayxMIiBnjgE90Ra2dtdSaM8mbM9OXfeBuy0CcuYY0BNsYWt3HuHhNqMDe9d/ZnyLgJw5BtR6/ITxLZNnMq/eC9dYmEJAzhwDepwtbJ24lkJ7Vmq4xsLUEAJy5hjQY21h6/gz0LEbdoZH170PIiBnYwG9ZuAyy/KpbHTpx9jC1rFrKRy5YpQNAdVm++m/5DQ2HNCjbWFrdy2F0E+4xsLUEAJy5hjQo2zDzaOLK7Q//2nfPodrLEwiIGeOAT3SljeEgJw5BvQIW94QAnLmGNDDbXlDCMiZY0APs+UNISBnjgE91JY3hICcOQb0EFveEAJy5hjQg215QwjImWNAD7LlDSEgZ44BPdCWN4SAnDkG9ABb3hACcuYY0P1teUMIyJljQJfY8oYQkDPHgC625Q0hIGeOAd3XljeEgJw5BnQfW94QAnLmGNC9bXlDCMiZY0AX2fKGEJAzx4AutOUNISBnjgFdYMsbQkBOtm4P5Em7d+++/vo9Qxm/8DzbcHN3bny4xwfO1WRruNUD2rBzbGFrd258uNc9MI6AnFQQ0Nm2sLU7Lyzc40N3q1JBQK0tE8a3dGemhnt87HdVKgkorjs3PtybOFl+hICcVB8Qz0B1qz4g3gPVrfqAunPjw73ugXEE5KT6gLpz4/k5UI3qDygNATkhoL4Q0FwjICcE1BcCmmsE5ISA+kJAc42AnBBQXwhorhGQEwLqCwHNNQJyQkB9IaC5RkBOCKgvBDTXCMgJAfWFgOYaATkhoL4Q0FwjICcE1BcCmmsE5ISA+kJAc42AnBBQXwhorhGQEwLqCwHNNQJyQkB9IaC5RkBOCKgvBDTXCMgJAfWFgOYaATkhoL4Q0EizrbV1zZZTuMdAYyl9HATkxAzIYT9UBOSEgPpCQCONw36oCMgJAfWFgEYah/1QEZATAuoLAY00DvuhIiAnBNQXAhppHPZDRUBOCKgvBDTSOOyHioCcEFBfCGikcdgPFQE5IaC+ENBI47AfKgJyQkB9IaCRxmE/VATkhID6QkAjjcN+qAjICQH1hYBGGof9UBGQk2FArqdU9ICAnGw1HmtK70QPCMgJAfWFgEaa0jvRAwJyQkB9IaCRpvRO9ICAnBBQXwhopCm9Ez0gICcE1BcCGmlK70QPCMgJAfXlgph7xpwfcV7MuRHnxJyd66yYrVHGb0VT+ve+B/4B3U0RECQEBAkBQUJAkBAQJAQECQFBQkCQEBAkBASJFdA2PisDqayA5hEBOSEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBIZhIQH3Vw9zGbgGYx9NQIyAkBQUJAkBAQJAQECQFBQkCQEBAkBAQJAUFCQJAQECQEBAkBQUJAkBAQJAQECQFBQkCQEBAk22K2nFYTV/44CGiRNOWXJKBF0pRfkoAWSVN+SQJaJE35JQlokTTllySgRdKUX5KAFklTfkkCWiRN+SUJaJE05ZckoEXSlF+SgBZJU35JAlokTfklCWiRNOWXJKBF0pRfkoAWSVN+SQJaJE35JQlokTTllySgRdKUX5KAFklTfkkCWiRN+SUJaJE05ZckoEXCRx1g3hAQJAQECQFBQkCQEBAkBAQJAUFCQJAQECQEBAkBQUJAkBAQJAQECQFBQkCQEBAkBAQJAUFCQJAQECQEBMmpA1qyXGo+OiMlF1vYA5vls8QGZl/a/17UsdjCHtgsEZDPWgRUCAFVjjfRkBAQJAQECQFBQkCQpAZ0/MZd37pz/F73QP+62Uf/uGvX/pWV/+3ateubt814rbBIkQNr12qPbIYHVkhiQCdvWT3Yb4/d6x7oXzf7+F9vXTn6p1tXDu2fzUrja4VFyhxY667VlmZ3YKUkBnT8b7etHP3zbd297oH+dbPvan+3D+0/+Z9bZ7LQxFphkTIHtrL2h2OGB1ZKYkBH/3Ln4IhH97oH+jc5e/Xe6jP/4JVspmuFRYodWPtUNMMDKyUxoPbpdu3Qw73ugf5NzD55y77Bq9iM/rB2a4VFSh3Y4HaGB1ZK7c9Ax2/cFx6dzduFqeM4tL/Ugd01eqc+3++D6n4PtPpd2Oh3dza/z1PHcWh/qfdAh/Z1a85ksUKSvwvbN/oubN/ad2H7ZvjNynB26Kf903ryvzP5l9qtFRYpc2DhhWuGB1ZK3s+B2j8+xX4OtLrY2I9LvjGjdwrdgYVFihzY8JVshgdWCD+JhoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSP4PyuiBAfJ8e3IAAAAASUVORK5CYII=" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
