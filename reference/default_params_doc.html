<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function's purpose is to list all parameter documentation to be
inherited by the relevant functions."><title>Default parameter documentation — default_params_doc • secsse</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Default parameter documentation — default_params_doc"><meta property="og:description" content="This function's purpose is to list all parameter documentation to be
inherited by the relevant functions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">secsse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/starting_secsse.html">Starting secsse</a>
    <a class="dropdown-item" href="../articles/plotting_states.html">Plotting probabilities</a>
    <a class="dropdown-item" href="../articles/sim_with_secsse.html">Simulating with secsse</a>
    <a class="dropdown-item" href="../articles/complete_tree.html">Using secsse with complete phylogenies (with extinction)</a>
    <a class="dropdown-item" href="../articles/secsse_performance.html">Secsse performance</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rsetienne/secsse/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Default parameter documentation</h1>
      <small class="dont-index">Source: <a href="https://github.com/rsetienne/secsse/blob/HEAD/R/default_params_doc.R" class="external-link"><code>R/default_params_doc.R</code></a></small>
      <div class="d-none name"><code>default_params_doc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function's purpose is to list all parameter documentation to be
inherited by the relevant functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">default_params_doc</span><span class="op">(</span></span>
<span>  <span class="va">phy</span>,</span>
<span>  <span class="va">traits</span>,</span>
<span>  <span class="va">num_concealed_states</span>,</span>
<span>  <span class="va">idparslist</span>,</span>
<span>  <span class="va">initparsopt</span>,</span>
<span>  <span class="va">idparsfix</span>,</span>
<span>  <span class="va">idparsopt</span>,</span>
<span>  <span class="va">idfactorsopt</span>,</span>
<span>  <span class="va">parsfix</span>,</span>
<span>  <span class="va">cond</span>,</span>
<span>  <span class="va">root_state_weight</span>,</span>
<span>  <span class="va">sampling_fraction</span>,</span>
<span>  <span class="va">tol</span>,</span>
<span>  <span class="va">maxiter</span>,</span>
<span>  <span class="va">optimethod</span>,</span>
<span>  <span class="va">num_cycles</span>,</span>
<span>  <span class="va">loglik_penalty</span>,</span>
<span>  <span class="va">is_complete_tree</span>,</span>
<span>  <span class="va">verbose</span>,</span>
<span>  <span class="va">num_threads</span>,</span>
<span>  <span class="va">atol</span>,</span>
<span>  <span class="va">rtol</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  <span class="va">parameter</span>,</span>
<span>  <span class="va">setting_calculation</span>,</span>
<span>  <span class="va">num_steps</span>,</span>
<span>  <span class="va">see_ancestral_states</span>,</span>
<span>  <span class="va">lambdas</span>,</span>
<span>  <span class="va">mus</span>,</span>
<span>  <span class="va">qs</span>,</span>
<span>  <span class="va">crown_age</span>,</span>
<span>  <span class="va">pool_init_states</span>,</span>
<span>  <span class="va">maxSpec</span>,</span>
<span>  <span class="va">conditioning</span>,</span>
<span>  <span class="va">non_extinction</span>,</span>
<span>  <span class="va">max_tries</span>,</span>
<span>  <span class="va">drop_extinct</span>,</span>
<span>  <span class="va">seed</span>,</span>
<span>  <span class="va">prob_func</span>,</span>
<span>  <span class="va">parameters</span>,</span>
<span>  <span class="va">masterBlock</span>,</span>
<span>  <span class="va">diff.conceal</span>,</span>
<span>  <span class="va">trait_info</span>,</span>
<span>  <span class="va">lambd_and_modeSpe</span>,</span>
<span>  <span class="va">initloglik</span>,</span>
<span>  <span class="va">initfactors</span>,</span>
<span>  <span class="va">idparsfuncdefpar</span>,</span>
<span>  <span class="va">functions_defining_params</span>,</span>
<span>  <span class="va">state_names</span>,</span>
<span>  <span class="va">transition_matrix</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">concealed_spec_rates</span>,</span>
<span>  <span class="va">shift_matrix</span>,</span>
<span>  <span class="va">q_matrix</span>,</span>
<span>  <span class="va">lambda_list</span>,</span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">params</span>,</span>
<span>  <span class="va">param_posit</span>,</span>
<span>  <span class="va">ml_pars</span>,</span>
<span>  <span class="va">mu_vector</span>,</span>
<span>  <span class="va">max_spec</span>,</span>
<span>  <span class="va">min_spec</span>,</span>
<span>  <span class="va">max_species_extant</span>,</span>
<span>  <span class="va">tree_size_hist</span>,</span>
<span>  <span class="va">start_at_crown</span>,</span>
<span>  <span class="va">optimmethod</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>phy</dt>
<dd><p>phylogenetic tree of class <code>phylo</code>, rooted and with
branch lengths.</p></dd>


<dt>traits</dt>
<dd><p>vector with trait states for each tip in the phylogeny. The
order of the states must be the same as the tree tips. For help, see
<code><a href="../articles/starting_secsse.html">vignette("starting_secsse", package = "secsse")</a></code>.</p></dd>


<dt>num_concealed_states</dt>
<dd><p>number of concealed states, generally equivalent
to the number of examined states in the dataset.</p></dd>


<dt>idparslist</dt>
<dd><p>overview of parameters and their values.</p></dd>


<dt>initparsopt</dt>
<dd><p>a numeric vector with the initial guess of the parameters
to be estimated.</p></dd>


<dt>idparsfix</dt>
<dd><p>a numeric vector with the ID of the fixed parameters.</p></dd>


<dt>idparsopt</dt>
<dd><p>a numeric vector with the ID of parameters to be estimated.</p></dd>


<dt>idfactorsopt</dt>
<dd><p>id of the factors that will be optimized. There are not
fixed factors, so use a constant within <code>functions_defining_params</code>.</p></dd>


<dt>parsfix</dt>
<dd><p>a numeric vector with the value of the fixed parameters.</p></dd>


<dt>cond</dt>
<dd><p>condition on the existence of a node root: <code>"maddison_cond"</code>,
<code>"proper_cond"</code> (default). For details, see vignette.</p></dd>


<dt>root_state_weight</dt>
<dd><p>the method to weigh the states:
<code>"maddison_weights"</code>, <code>"proper_weights"</code> (default) or <code>"equal_weights"</code>.
It can also be specified for the root state: the vector <code>c(1, 0, 0)</code>
indicates state 1 was the root state.</p></dd>


<dt>sampling_fraction</dt>
<dd><p>vector that states the sampling proportion per
trait state. It must have as many elements as there are trait states.</p></dd>


<dt>tol</dt>
<dd><p>A numeric vector with the maximum tolerance of the optimization
algorithm. Default is <code>c(1e-04, 1e-05, 1e-05)</code>.</p></dd>


<dt>maxiter</dt>
<dd><p>max number of iterations. Default is
<code>1000 * round((1.25) ^ length(idparsopt))</code>.</p></dd>


<dt>num_cycles</dt>
<dd><p>Number of cycles of the optimization. When set to <code>Inf</code>,
the optimization will be repeated until the result is, within the
tolerance, equal to the starting values, with a maximum of 10 cycles.</p></dd>


<dt>loglik_penalty</dt>
<dd><p>the size of the penalty for all parameters; default is
0 (no penalty).</p></dd>


<dt>is_complete_tree</dt>
<dd><p>logical specifying whether or not a tree with all its
extinct species is provided. If set to <code>TRUE</code>, it also assumes that all
<em>all</em> extinct lineages are present on the tree. Defaults to <code>FALSE</code>.</p></dd>


<dt>verbose</dt>
<dd><p>sets verbose output; default is <code>TRUE</code> when <code>optimmethod</code> is
<code>"simplex"</code>. If <code>optimmethod</code> is set to <code>"simplex"</code>, then even if set to
<code>FALSE</code>, optimizer output will be shown.</p></dd>


<dt>num_threads</dt>
<dd><p>number of threads to be used. Default is one thread.</p></dd>


<dt>atol</dt>
<dd><p>A numeric specifying the absolute tolerance of integration.</p></dd>


<dt>rtol</dt>
<dd><p>A numeric specifying the relative tolerance of integration.</p></dd>


<dt>method</dt>
<dd><p>integration method used, available are:
<code>"odeint::runge_kutta_cash_karp54"</code>, <code>"odeint::runge_kutta_fehlberg78"</code>,
<code>"odeint::runge_kutta_dopri5"</code>, <code>"odeint::bulirsch_stoer"</code> and
<code>"odeint::runge_kutta4"</code>. Default method is: <code>"odeint::bulirsch_stoer"</code>.</p></dd>


<dt>parameter</dt>
<dd><p>list where first vector represents lambdas, the second
mus and the third transition rates.</p></dd>


<dt>setting_calculation</dt>
<dd><p>argument used internally to speed up calculation.
It should be left blank (default : <code>setting_calculation = NULL</code>).</p></dd>


<dt>num_steps</dt>
<dd><p>number of substeps to show intermediate likelihoods
along a branch.</p></dd>


<dt>see_ancestral_states</dt>
<dd><p>Boolean for whether the ancestral states should
be shown? Defaults to <code>FALSE</code>.</p></dd>


<dt>lambdas</dt>
<dd><p>speciation rates, in the form of a list of matrices.</p></dd>


<dt>mus</dt>
<dd><p>extinction rates, in the form of a vector.</p></dd>


<dt>qs</dt>
<dd><p>The Q matrix, for example the result of function q_doubletrans, but
generally in the form of a matrix.</p></dd>


<dt>crown_age</dt>
<dd><p>crown age of the tree, tree will be simulated conditional
on non-extinction and this crown age.</p></dd>


<dt>pool_init_states</dt>
<dd><p>pool of initial states at the crown, in case this is
different from all available states, otherwise leave at NULL</p></dd>


<dt>conditioning</dt>
<dd><p>can be <code>"obs_states"</code>, <code>"true_states"</code> or <code>"none"</code>, the
tree is simulated until one is generated that contains all observed states
(<code>"obs_states"</code>), all true states (e.g. all combinations of obs and hidden
states), or is always returned (<code>"none"</code>). Alternatively, a vector with
the names of required observed states can be provided, e.g. c("S", "N").</p></dd>


<dt>non_extinction</dt>
<dd><p>boolean stating if the tree should be conditioned on
non-extinction of the crown lineages. Defaults to <code>TRUE</code>.</p></dd>


<dt>max_tries</dt>
<dd><p>maximum number of simulations to try to obtain a tree.</p></dd>


<dt>drop_extinct</dt>
<dd><p>boolean stating if extinct species should be dropped from
the tree. Defaults to <code>TRUE</code>.</p></dd>


<dt>seed</dt>
<dd><p>pseudo-random number generator seed.</p></dd>


<dt>prob_func</dt>
<dd><p>a function to calculate the probability of interest, see
description.</p></dd>


<dt>parameters</dt>
<dd><p>list where first vector represents lambdas, the second mus
and the third transition rates.</p></dd>


<dt>masterBlock</dt>
<dd><p>matrix of transitions among only examined states, <code>NA</code> in
the main diagonal, used to build the full transition rates matrix.</p></dd>


<dt>diff.conceal</dt>
<dd><p>Boolean stating if the concealed states should be
different. E.g. that the transition rates for the concealed
states are different from the transition rates for the examined states.
Normally it should be <code>FALSE</code> in order to avoid having a huge number of
parameters.</p></dd>


<dt>trait_info</dt>
<dd><p>data frame where first column has species ids and the second
one is the trait associated information.</p></dd>


<dt>lambd_and_modeSpe</dt>
<dd><p>a matrix with the 4 models of speciation possible.</p></dd>


<dt>initloglik</dt>
<dd><p>A numeric with the value of loglikehood obtained prior to
optimisation. Only used internally.</p></dd>


<dt>initfactors</dt>
<dd><p>the initial guess for a factor (it should be set to <code>NULL</code>
when no factors).</p></dd>


<dt>idparsfuncdefpar</dt>
<dd><p>id of the parameters which will be a function of
optimized and/or fixed parameters. The order of id should match
<code>functions_defining_params</code>.</p></dd>


<dt>functions_defining_params</dt>
<dd><p>a list of functions. Each element will be a
function which defines a parameter e.g. <code>id_3 &lt;- (id_1 + id_2) / 2</code>. See
example.</p></dd>


<dt>state_names</dt>
<dd><p>vector of names of all observed states.</p></dd>


<dt>transition_matrix</dt>
<dd><p>a matrix containing a description of all speciation
events, where the first column indicates the source state, the second and
third column indicate the two daughter states, and the fourth column gives
the rate indicator used. E.g.: <code>["SA", "S", "A", 1]</code> for a trait state
<code>"SA"</code> which upon speciation generates two daughter species with traits
<code>"S"</code> and <code>"A"</code>, where the number 1 is used as indicator for optimization
of the likelihood.</p></dd>


<dt>model</dt>
<dd><p>used model, choice of <code>"ETD"</code> (Examined Traits Diversification),
<code>"CTD"</code> (Concealed Traits Diversification) or <code>"CR"</code> (Constant Rate).</p></dd>


<dt>concealed_spec_rates</dt>
<dd><p>vector specifying the rate indicators for each
concealed state, length should be identical to <code>num_concealed_states</code>. If
left empty when using the CTD model, it is assumed that all available
speciation rates are distributed uniformly over the concealed states.</p></dd>


<dt>shift_matrix</dt>
<dd><p>matrix of shifts, indicating in order:</p><ol><li><p>starting state (typically the column in the transition matrix)</p></li>
<li><p>ending state (typically the row in the transition matrix)</p></li>
<li><p>associated rate indicator.</p></li>
</ol></dd>


<dt>q_matrix</dt>
<dd><p><code>q_matrix</code> with only transitions between observed states.</p></dd>


<dt>lambda_list</dt>
<dd><p>previously generated list of lambda matrices,
used to infer the rate number to start with.</p></dd>


<dt>object</dt>
<dd><p>lambda matrices, <code>q_matrix</code> or mu vector.</p></dd>


<dt>params</dt>
<dd><p>parameters in order, where each value reflects the value
of the parameter at that position, e.g. <code>c(0.3, 0.2, 0.1)</code> will fill out
the value 0.3 for the parameter with rate identifier 1, 0.2 for the
parameter with rate identifier 2 and 0.1 for the parameter with rate
identifier 3.</p></dd>


<dt>param_posit</dt>
<dd><p>initial parameter structure, consisting of a list with
three entries:</p><ol><li><p>lambda matrices</p></li>
<li><p>mus</p></li>
<li><p>Q matrix</p></li>
</ol><p>In each entry, integers numbers (1-n) indicate the parameter to be
optimized.</p></dd>


<dt>ml_pars</dt>
<dd><p>resulting parameter estimates as returned by for instance
<code><a href="cla_secsse_ml.html">cla_secsse_ml()</a></code>, having the same structure as <code>param_post</code>.</p></dd>


<dt>mu_vector</dt>
<dd><p>previously defined mus - used to choose indicator number.</p></dd>


<dt>max_spec</dt>
<dd><p>Maximum number of species in the tree (please note that the
tree is not conditioned on this number, but that this is a safeguard
against generating extremely large trees).</p></dd>


<dt>min_spec</dt>
<dd><p>Minimum number of species in the tree.</p></dd>


<dt>max_species_extant</dt>
<dd><p>Should the maximum number of species be counted in
the reconstructed tree (if TRUE) or in the complete tree (if FALSE).</p></dd>


<dt>tree_size_hist</dt>
<dd><p>if TRUE, returns a vector of all found tree sizes.</p></dd>


<dt>start_at_crown</dt>
<dd><p>if FALSE, the simulation starts with one species
instead of the two assumed by default by secsse (also in ML), and
the resulting crown age will be lower than the set crown age. This allows
for direct comparison with BiSSE and facilitates implementing speciation
effects at the crown.</p></dd>


<dt>optimmethod</dt>
<dd><p>A string with method used for optimization. Default is
<code>"subplex"</code>. Alternative is <code>"simplex"</code> and it shouldn't be used in normal
conditions (only for debugging). Both are called from <code><a href="https://rdrr.io/pkg/DDD/man/optimizer.html" class="external-link">DDD::optimizer()</a></code>,
simplex is implemented natively in <a href="https://rdrr.io/pkg/DDD/man/DDD-package.html" class="external-link">DDD</a>, while subplex is ultimately
called from <code><a href="https://rdrr.io/pkg/subplex/man/subplex.html" class="external-link">subplex::subplex()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Nothing</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leonel Herrera Alsina, Paul van Els, Rampal S. Etienne.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

