<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Maximum likehood estimation for (SecSSE) — cla_secsse_ml • secsse</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum likehood estimation for (SecSSE) — cla_secsse_ml"><meta name="description" content="Maximum likehood estimation under Several examined and concealed
States-dependent Speciation and Extinction (SecSSE) with cladogenetic option"><meta property="og:description" content="Maximum likehood estimation under Several examined and concealed
States-dependent Speciation and Extinction (SecSSE) with cladogenetic option"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">secsse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/starting_secsse.html">Starting secsse</a></li>
    <li><a class="dropdown-item" href="../articles/plotting_states.html">Plotting probabilities</a></li>
    <li><a class="dropdown-item" href="../articles/sim_with_secsse.html">Simulating with secsse</a></li>
    <li><a class="dropdown-item" href="../articles/complete_tree.html">Using secsse with complete phylogenies (with extinction)</a></li>
    <li><a class="dropdown-item" href="../articles/secsse_performance.html">Secsse performance</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rsetienne/secsse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Maximum likehood estimation for (SecSSE)</h1>
      <small class="dont-index">Source: <a href="https://github.com/rsetienne/secsse/blob/master/R/secsse_ml.R" class="external-link"><code>R/secsse_ml.R</code></a></small>
      <div class="d-none name"><code>cla_secsse_ml.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Maximum likehood estimation under Several examined and concealed
States-dependent Speciation and Extinction (SecSSE) with cladogenetic option</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cla_secsse_ml</span><span class="op">(</span></span>
<span>  <span class="va">phy</span>,</span>
<span>  <span class="va">traits</span>,</span>
<span>  <span class="va">num_concealed_states</span>,</span>
<span>  <span class="va">idparslist</span>,</span>
<span>  <span class="va">idparsopt</span>,</span>
<span>  <span class="va">initparsopt</span>,</span>
<span>  <span class="va">idparsfix</span>,</span>
<span>  <span class="va">parsfix</span>,</span>
<span>  cond <span class="op">=</span> <span class="st">"proper_cond"</span>,</span>
<span>  root_state_weight <span class="op">=</span> <span class="st">"proper_weights"</span>,</span>
<span>  <span class="va">sampling_fraction</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-04</span>, <span class="fl">1e-05</span>, <span class="fl">1e-07</span><span class="op">)</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idparsopt</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  optimmethod <span class="op">=</span> <span class="st">"simplex"</span>,</span>
<span>  num_cycles <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  loglik_penalty <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  is_complete_tree <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  take_into_account_root_edge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num_threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  atol <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  rtol <span class="op">=</span> <span class="fl">1e-07</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"odeint::bulirsch_stoer"</span>,</span>
<span>  use_normalization <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>phylogenetic tree of class <code>phylo</code>, rooted and with
branch lengths. Alternatively, multiple phylogenetic trees can be provided
as the <code>multiPhylo</code> class.</p></dd>


<dt id="arg-traits">traits<a class="anchor" aria-label="anchor" href="#arg-traits"></a></dt>
<dd><p>vector with trait states for each tip in the phylogeny. The
order of the states must be the same as the tree tips. For help, see
<code><a href="../articles/starting_secsse.html">vignette("starting_secsse", package = "secsse")</a></code>. When providing a
<code>multiPhylo</code> set of multiple phylognies, traits should be a list where
each entry in the list corresponds to the matching phylogeny on that
position.</p></dd>


<dt id="arg-num-concealed-states">num_concealed_states<a class="anchor" aria-label="anchor" href="#arg-num-concealed-states"></a></dt>
<dd><p>number of concealed states, generally equivalent
to the number of examined states in the dataset.</p></dd>


<dt id="arg-idparslist">idparslist<a class="anchor" aria-label="anchor" href="#arg-idparslist"></a></dt>
<dd><p>overview of parameters and their values.</p></dd>


<dt id="arg-idparsopt">idparsopt<a class="anchor" aria-label="anchor" href="#arg-idparsopt"></a></dt>
<dd><p>a numeric vector with the ID of parameters to be estimated.</p></dd>


<dt id="arg-initparsopt">initparsopt<a class="anchor" aria-label="anchor" href="#arg-initparsopt"></a></dt>
<dd><p>a numeric vector with the initial guess of the parameters
to be estimated.</p></dd>


<dt id="arg-idparsfix">idparsfix<a class="anchor" aria-label="anchor" href="#arg-idparsfix"></a></dt>
<dd><p>a numeric vector with the ID of the fixed parameters.</p></dd>


<dt id="arg-parsfix">parsfix<a class="anchor" aria-label="anchor" href="#arg-parsfix"></a></dt>
<dd><p>a numeric vector with the value of the fixed parameters.</p></dd>


<dt id="arg-cond">cond<a class="anchor" aria-label="anchor" href="#arg-cond"></a></dt>
<dd><p>condition on the existence of a node root: <code>"maddison_cond"</code>,
<code>"proper_cond"</code> (default). For details, see vignette.</p></dd>


<dt id="arg-root-state-weight">root_state_weight<a class="anchor" aria-label="anchor" href="#arg-root-state-weight"></a></dt>
<dd><p>the method to weigh the states:
<code>"maddison_weights"</code>, <code>"proper_weights"</code> (default) or <code>"equal_weights"</code>.
It can also be specified for the root state: the vector <code>c(1, 0, 0)</code>
indicates state 1 was the root state. When
using a <code>multiPhylo</code> object, root_state_weight should be list where each
entry in the list corresponds to the root_state_weight for each tree.</p></dd>


<dt id="arg-sampling-fraction">sampling_fraction<a class="anchor" aria-label="anchor" href="#arg-sampling-fraction"></a></dt>
<dd><p>vector that states the sampling proportion per
trait state. It must have as many elements as there are trait states. When
using a <code>multiPhylo</code> object, sampling fraction should be list where each
entry in the list corresponds to the sampling proportion for each tree.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>A numeric vector with the maximum tolerance of the optimization
algorithm. Default is <code>c(1e-04, 1e-05, 1e-05)</code>.</p></dd>


<dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>max number of iterations. Default is
<code>1000 * round((1.25) ^ length(idparsopt))</code>.</p></dd>


<dt id="arg-optimmethod">optimmethod<a class="anchor" aria-label="anchor" href="#arg-optimmethod"></a></dt>
<dd><p>A string with method used for optimization. Default is
<code>"simplex"</code>. Alternative is <code>"subplex"</code>. Both are called from
<code><a href="https://rdrr.io/pkg/DDD/man/optimizer.html" class="external-link">DDD::optimizer()</a></code>, simplex is implemented natively in <span class="pkg">DDD</span>, while subplex
is ultimately called from <code><a href="https://rdrr.io/pkg/subplex/man/subplex.html" class="external-link">subplex::subplex()</a></code>.</p></dd>


<dt id="arg-num-cycles">num_cycles<a class="anchor" aria-label="anchor" href="#arg-num-cycles"></a></dt>
<dd><p>Number of cycles of the optimization. When set to <code>Inf</code>,
the optimization will be repeated until the result is, within the
tolerance, equal to the starting values, with a maximum of 10 cycles.</p></dd>


<dt id="arg-loglik-penalty">loglik_penalty<a class="anchor" aria-label="anchor" href="#arg-loglik-penalty"></a></dt>
<dd><p>the size of the penalty for all parameters; default is
0 (no penalty).</p></dd>


<dt id="arg-is-complete-tree">is_complete_tree<a class="anchor" aria-label="anchor" href="#arg-is-complete-tree"></a></dt>
<dd><p>logical specifying whether or not a tree with all its
extinct species is provided. If set to <code>TRUE</code>, it also assumes that all
<em>all</em> extinct lineages are present on the tree. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-take-into-account-root-edge">take_into_account_root_edge<a class="anchor" aria-label="anchor" href="#arg-take-into-account-root-edge"></a></dt>
<dd><p>if TRUE, the LL integration is continued
along the root edge. This also affects conditioning (as now, conditioning
no longer needs to assume a speciation event at the start of the tree)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>sets verbose output; default is <code>TRUE</code> when <code>optimmethod</code> is
<code>"simplex"</code>. If <code>optimmethod</code> is set to <code>"simplex"</code>, then even if set to
<code>FALSE</code>, optimizer output will be shown.</p></dd>


<dt id="arg-num-threads">num_threads<a class="anchor" aria-label="anchor" href="#arg-num-threads"></a></dt>
<dd><p>number of threads to be used. Default is one thread.</p></dd>


<dt id="arg-atol">atol<a class="anchor" aria-label="anchor" href="#arg-atol"></a></dt>
<dd><p>A numeric specifying the absolute tolerance of integration.</p></dd>


<dt id="arg-rtol">rtol<a class="anchor" aria-label="anchor" href="#arg-rtol"></a></dt>
<dd><p>A numeric specifying the relative tolerance of integration.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>integration method used, available are:
<code>"odeint::runge_kutta_cash_karp54"</code>, <code>"odeint::runge_kutta_fehlberg78"</code>,
<code>"odeint::runge_kutta_dopri5"</code>, <code>"odeint::bulirsch_stoer"</code> and
<code>"odeint::runge_kutta4"</code>. Default method is: <code>"odeint::bulirsch_stoer"</code>.</p></dd>


<dt id="arg-use-normalization">use_normalization<a class="anchor" aria-label="anchor" href="#arg-use-normalization"></a></dt>
<dd><p>normalize the density vector during integration,
more accurate but slower (default = TRUE)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Parameter estimated and maximum likelihood</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example of how to set the arguments for a ML search.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsetienne.github.io/secsse/">secsse</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DDD</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">13</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Check the vignette for a better working exercise.</span></span></span>
<span class="r-in"><span><span class="co"># lambdas for 0A and 1A and 2A are the same but need to be estimated</span></span></span>
<span class="r-in"><span><span class="co"># (CTD model, see Syst Biol paper)</span></span></span>
<span class="r-in"><span><span class="co"># mus are fixed to zero,</span></span></span>
<span class="r-in"><span><span class="co"># the transition rates are constrained to be equal and fixed 0.01</span></span></span>
<span class="r-in"><span><span class="va">phylotree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rcoal</a></span><span class="op">(</span><span class="fl">31</span>, tip.label <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">31</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#get some traits</span></span></span>
<span class="r-in"><span><span class="va">traits</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Ntip</a></span><span class="op">(</span><span class="va">phylotree</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">num_concealed_states</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span> <span class="op">&lt;-</span> <span class="fu"><a href="cla_id_paramPos.html">cla_id_paramPos</a></span><span class="op">(</span><span class="va">traits</span>,<span class="va">num_concealed_states</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">$</span><span class="va">lambdas</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">masterBlock</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">5</span>,ncol <span class="op">=</span> <span class="fl">3</span>,nrow <span class="op">=</span> <span class="fl">3</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">masterBlock</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">diff.conceal</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="q_doubletrans.html">q_doubletrans</a></span><span class="op">(</span><span class="va">traits</span>,<span class="va">masterBlock</span>,<span class="va">diff.conceal</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">startingpoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DDD/man/bd_ML.html" class="external-link">bd_ML</a></span><span class="op">(</span>brts <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html" class="external-link">branching.times</a></span><span class="op">(</span><span class="va">phylotree</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> You are optimizing lambda0 mu0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> You are fixing lambda1 mu1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimizing the likelihood - this may take a while. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The loglikelihood for the initial parameter values is -67.5669039297515.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum likelihood parameter estimates: lambda0: 15.604290, mu0: 15.874464, lambda1: 0.000000, mu1: 0.000000: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum loglikelihood: 25.282018</span>
<span class="r-in"><span><span class="va">intGuessLamba</span> <span class="op">&lt;-</span> <span class="va">startingpoint</span><span class="op">$</span><span class="va">lambda0</span></span></span>
<span class="r-in"><span><span class="va">intGuessMu</span> <span class="op">&lt;-</span> <span class="va">startingpoint</span><span class="op">$</span><span class="va">mu0</span></span></span>
<span class="r-in"><span><span class="va">idparsopt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">initparsopt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">intGuessLamba</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idparsfix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">parsfix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-04</span>, <span class="fl">1e-05</span>, <span class="fl">1e-07</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">maxiter</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span> <span class="op">^</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idparsopt</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">optimmethod</span> <span class="op">&lt;-</span> <span class="st">'simplex'</span></span></span>
<span class="r-in"><span><span class="va">cond</span> <span class="op">&lt;-</span> <span class="st">'proper_cond'</span></span></span>
<span class="r-in"><span><span class="va">root_state_weight</span> <span class="op">&lt;-</span> <span class="st">'proper_weights'</span></span></span>
<span class="r-in"><span><span class="va">sampling_fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">cla_secsse_ml</span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="va">phylotree</span>,</span></span>
<span class="r-in"><span> <span class="va">traits</span>,</span></span>
<span class="r-in"><span> <span class="va">num_concealed_states</span>,</span></span>
<span class="r-in"><span> <span class="va">idparslist</span>,</span></span>
<span class="r-in"><span> <span class="va">idparsopt</span>,</span></span>
<span class="r-in"><span> <span class="va">initparsopt</span>,</span></span>
<span class="r-in"><span> <span class="va">idparsfix</span>,</span></span>
<span class="r-in"><span> <span class="va">parsfix</span>,</span></span>
<span class="r-in"><span> <span class="va">cond</span>,</span></span>
<span class="r-in"><span> <span class="va">root_state_weight</span>,</span></span>
<span class="r-in"><span> <span class="va">sampling_fraction</span>,</span></span>
<span class="r-in"><span> <span class="va">tol</span>,</span></span>
<span class="r-in"><span> <span class="va">maxiter</span>,</span></span>
<span class="r-in"><span> <span class="va">optimmethod</span>,</span></span>
<span class="r-in"><span> num_cycles <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span> num_threads <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span> verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Note: you set some transitions as impossible to happen.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 15.6042898684248 15.6042898684248 15.6042898684248 -121.487683644503 initial </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 16.3845043618461 16.3845043618461 14.2366516329269 -115.872102944723 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 16.3845043618461 16.3845043618461 14.2366516329269 -115.872102944723 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 16.1164115482592 15.8564618714564 13.4435417361893 -112.708848926855 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 16.661129036425 17.8616456533575 11.7804033067207 -106.427344244374 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 18.8748937365321 16.661129036425 10.7024010667367 -102.649990642589 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 18.8748937365321 17.5464711985784 8.83574291518734 -96.8407390014834 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 23.7499826152845 21.2672928057985 6.8803975853617 -92.1784039041511 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 34.9835268796627 19.2372760644554 5.34799248335495 -90.118153445057 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 33.8535718517169 22.6933092609064 4.81579185777643 -89.8916336320649 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 33.8535718517169 22.6933092609064 4.81579185777643 -89.8916336320649 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 33.8535718517169 22.6933092609064 4.81579185777643 -89.8916336320649 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 33.8535718517169 22.6933092609064 4.81579185777643 -89.8916336320649 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 33.8535718517169 22.6933092609064 4.81579185777643 -89.8916336320649 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 33.8535718517169 22.6933092609064 4.81579185777643 -89.8916336320649 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 33.8535718517169 22.6933092609064 4.81579185777643 -89.8916336320649 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 33.8535718517169 22.6933092609064 4.81579185777643 -89.8916336320649 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 33.8535718517169 22.6933092609064 4.81579185777643 -89.8916336320649 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 40.0611420950045 21.5954238570094 4.64166201307183 -89.8907284337715 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 40.0611420950045 21.5954238570094 4.64166201307183 -89.8907284337715 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 38.7838963866625 22.09252160483 4.68738843123826 -89.8892656096984 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 38.7838963866625 22.09252160483 4.68738843123826 -89.8892656096984 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 36.0332588409853 22.4146047038665 4.73313430169762 -89.8867773517614 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 36.0332588409853 22.4146047038665 4.73313430169762 -89.8867773517614 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 36.0332588409853 22.4146047038665 4.73313430169762 -89.8867773517614 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 36.0332588409853 22.4146047038665 4.73313430169762 -89.8867773517614 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 33.7939708537398 23.1619267394853 4.67617743982144 -89.8846392966006 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 32.9570145766782 22.9967027764633 4.76019916146665 -89.8845175271118 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 28.8858477767871 25.9077673007118 4.66368227158788 -89.882769361436 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 25.5641274625481 27.7298236564981 4.63398478686598 -89.8786891959933 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 22.2163034259215 31.395418958883 4.70407868110388 -89.8743828184079 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 22.2163034259215 31.395418958883 4.70407868110388 -89.8743828184079 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 20.0301019807209 33.1020565748236 4.72372769998256 -89.8702085435553 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 20.0301019807209 33.1020565748236 4.72372769998256 -89.8702085435553 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 20.0301019807209 33.1020565748236 4.72372769998256 -89.8702085435553 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 20.0301019807209 33.1020565748236 4.72372769998256 -89.8702085435553 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 20.0301019807209 33.1020565748236 4.72372769998256 -89.8702085435553 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 19.2007230053455 33.5964443113748 4.73425605791087 -89.8687093432768 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 21.852133724945 29.7262450758438 4.71093041222478 -89.8681250737671 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 21.852133724945 29.7262450758438 4.71093041222478 -89.8681250737671 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 20.4365061188632 30.575466286766 4.69143428701633 -89.8641759306454 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 20.4365061188632 30.575466286766 4.69143428701633 -89.8641759306454 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 20.4365061188632 30.575466286766 4.69143428701633 -89.8641759306454 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 21.4498889292796 26.902167800435 4.68802298364535 -89.8561107507925 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 21.4498889292796 26.902167800435 4.68802298364535 -89.8561107507925 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 21.4498889292796 26.902167800435 4.68802298364535 -89.8561107507925 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 22.1288807686561 23.2912492321529 4.6175356044978 -89.8453677814197 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48 18.8060270739465 25.1791704795815 4.67267401030954 -89.8381782639351 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49 23.7069393574904 19.1938996609292 4.65026318942184 -89.8333474179573 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 21.1666443055712 16.4805975240266 4.56592684998421 -89.8164896536086 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51 19.1592610465612 14.9769117628143 4.65280890366182 -89.8023542183295 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52 19.1592610465612 14.9769117628143 4.65280890366182 -89.8023542183295 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53 19.1592610465612 14.9769117628143 4.65280890366182 -89.8023542183295 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54 16.7816791253283 16.063236451579 4.60155492072445 -89.7960967620457 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55 16.7816791253283 16.063236451579 4.60155492072445 -89.7960967620457 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56 16.4024847909521 15.9381640876111 4.67219593044267 -89.7956269434704 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57 14.3888583685557 13.8854168337677 4.61844421632923 -89.7902277035283 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58 14.3888583685557 13.8854168337677 4.61844421632923 -89.7902277035283 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59 14.3888583685557 13.8854168337677 4.61844421632923 -89.7902277035283 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60 14.3888583685557 13.8854168337677 4.61844421632923 -89.7902277035283 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61 14.3888583685557 13.8854168337677 4.61844421632923 -89.7902277035283 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62 14.3888583685557 13.8854168337677 4.61844421632923 -89.7902277035283 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63 14.3888583685557 13.8854168337677 4.61844421632923 -89.7902277035283 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64 14.3888583685557 13.8854168337677 4.61844421632923 -89.7902277035283 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65 14.3888583685557 13.8854168337677 4.61844421632923 -89.7902277035283 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66 14.3888583685557 13.8854168337677 4.61844421632923 -89.7902277035283 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67 14.3888583685557 13.8854168337677 4.61844421632923 -89.7902277035283 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68 14.3888583685557 13.8854168337677 4.61844421632923 -89.7902277035283 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69 14.479947109031 14.3019139360004 4.632966660664 -89.790134364218 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70 14.479947109031 14.3019139360004 4.632966660664 -89.790134364218 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71 14.3165211694009 14.4426137546406 4.62620711474184 -89.7900933522345 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72 14.3165211694009 14.4426137546406 4.62620711474184 -89.7900933522345 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73 14.3165211694009 14.4426137546406 4.62620711474184 -89.7900933522345 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74 14.3165211694009 14.4426137546406 4.62620711474184 -89.7900933522345 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75 14.3165211694009 14.4426137546406 4.62620711474184 -89.7900933522345 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76 14.2700219864961 14.2521569922074 4.62904905591931 -89.790083734614 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77 14.2983143356976 14.2021718429359 4.62582422769744 -89.7900806012583 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78 14.221226426761 14.2611310724199 4.62525765168725 -89.7900789365597 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79 14.2897745193455 14.3398487520842 4.62645845429466 -89.7900780845716 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80 14.2897745193455 14.3398487520842 4.62645845429466 -89.7900780845716 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81 14.2791672063135 14.2482219967064 4.62530586812449 -89.7900765570696 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82 14.2791672063135 14.2482219967064 4.62530586812449 -89.7900765570696 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83 14.2791672063135 14.2482219967064 4.62530586812449 -89.7900765570696 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84 14.2917847691801 14.3116125413044 4.62569994798662 -89.7900759897722 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85 14.3075194204976 14.3001429158248 4.6252070142897 -89.7900759636678 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86 14.2795695487546 14.284767481705 4.62478236023512 -89.7900757870763 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87 14.2860551741656 14.2734856077064 4.62526780839395 -89.7900756258652 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88 14.2914117364715 14.2988577515659 4.62539281690132 -89.7900756165761 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89 14.2914117364715 14.2988577515659 4.62539281690132 -89.7900756165761 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90 14.2972489602615 14.2902352324522 4.62552782925417 -89.7900755845008 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91 14.2865539185768 14.2821253532844 4.62561498430173 -89.7900755139471 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92 14.2888955366921 14.2819396517544 4.62538983921672 -89.7900755088518 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93 14.2888955366921 14.2819396517544 4.62538983921672 -89.7900755088518 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94 14.2846807997048 14.2828182579449 4.62546441956435 -89.7900754987062 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 14.2889320776448 14.2870499819648 4.62547079760205 -89.7900754931154 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96 14.2889320776448 14.2870499819648 4.62547079760205 -89.7900754931154 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97 14.2854975926543 14.2878672278503 4.62547033158942 -89.7900754902134 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98 14.2860746327832 14.284701868576 4.62544823761799 -89.7900754900842 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99 14.2860746327832 14.284701868576 4.62544823761799 -89.7900754900842 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 14.2876289009991 14.2865681365331 4.62545667365113 -89.7900754892193 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101 14.2858976636528 14.2867233685729 4.62548308150763 -89.7900754886156 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102 14.2860156252242 14.2869324247831 4.62546649790198 -89.7900754883962 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103 14.2862943244789 14.2857215205147 4.62545849428986 -89.7900754883374 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104 14.2868490120373 14.2865136112481 4.62546301575901 -89.7900754882581 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105 14.2866306489857 14.2862220747259 4.6254524632743 -89.7900754881498 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106 14.2863034697394 14.2865424000226 4.62546224449997 -89.7900754880921 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107 14.2863034697394 14.2865424000226 4.62546224449997 -89.7900754880921 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108 14.2863034697394 14.2865424000226 4.62546224449997 -89.7900754880921 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109 14.2861909542088 14.286278198347 4.62546196441823 -89.7900754880877 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110 14.2863486992497 14.286200699671 4.62545934866338 -89.7900754880772 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111 14.2862728867937 14.2862513719125 4.62545823286489 -89.7900754880749 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112 14.286287158092 14.2863929101707 4.62546104657393 -89.7900754880674 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113 14.286287158092 14.2863929101707 4.62546104657393 -89.7900754880674 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114 14.2863012480233 14.2864189041042 4.62545825161821 -89.7900754880669 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115 14.2863651978825 14.286422782472 4.62545909315536 -89.7900754880655 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116 14.2863663721646 14.2863483268366 4.62545829238331 -89.7900754880632 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117 14.2863663721646 14.2863483268366 4.62545829238331 -89.7900754880632 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118 14.2863663721646 14.2863483268366 4.62545829238331 -89.7900754880632 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 14.2863663721646 14.2863483268366 4.62545829238331 -89.7900754880632 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120 14.286344102566 14.2863670997777 4.62545951597678 -89.7900754880626 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 14.286344102566 14.2863670997777 4.62545951597678 -89.7900754880626 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 14.286344102566 14.2863670997777 4.62545951597678 -89.7900754880626 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123 14.286344102566 14.2863670997777 4.62545951597678 -89.7900754880626 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124 14.286344102566 14.2863670997777 4.62545951597678 -89.7900754880626 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 125 14.2863543354069 14.2863443871461 4.62545924341647 -89.7900754880626 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization has terminated successfully. </span>
<span class="r-in"><span><span class="co"># [1] -90.97626</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leonel Herrera Alsina, Paul van Els, Rampal S. Etienne.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

