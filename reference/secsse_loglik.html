<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Likelihood for SecSSE model Loglikelihood calculation for the SecSSE model given a set of parameters and data — secsse_loglik • secsse</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Likelihood for SecSSE model Loglikelihood calculation for the SecSSE model given a set of parameters and data — secsse_loglik"><meta name="description" content="Likelihood for SecSSE model
Loglikelihood calculation for the SecSSE model given a set of parameters and
data"><meta property="og:description" content="Likelihood for SecSSE model
Loglikelihood calculation for the SecSSE model given a set of parameters and
data"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">secsse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/starting_secsse.html">Starting secsse</a></li>
    <li><a class="dropdown-item" href="../articles/plotting_states.html">Plotting probabilities</a></li>
    <li><a class="dropdown-item" href="../articles/sim_with_secsse.html">Simulating with secsse</a></li>
    <li><a class="dropdown-item" href="../articles/complete_tree.html">Using secsse with complete phylogenies (with extinction)</a></li>
    <li><a class="dropdown-item" href="../articles/secsse_performance.html">Secsse performance</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rsetienne/secsse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Likelihood for SecSSE model Loglikelihood calculation for the SecSSE model given a set of parameters and data</h1>
      <small class="dont-index">Source: <a href="https://github.com/rsetienne/secsse/blob/master/R/secsse_loglik.R" class="external-link"><code>R/secsse_loglik.R</code></a></small>
      <div class="d-none name"><code>secsse_loglik.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Likelihood for SecSSE model
Loglikelihood calculation for the SecSSE model given a set of parameters and
data</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">secsse_loglik</span><span class="op">(</span></span>
<span>  <span class="va">parameter</span>,</span>
<span>  <span class="va">phy</span>,</span>
<span>  <span class="va">traits</span>,</span>
<span>  <span class="va">num_concealed_states</span>,</span>
<span>  cond <span class="op">=</span> <span class="st">"proper_cond"</span>,</span>
<span>  root_state_weight <span class="op">=</span> <span class="st">"proper_weights"</span>,</span>
<span>  <span class="va">sampling_fraction</span>,</span>
<span>  setting_calculation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  see_ancestral_states <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  loglik_penalty <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  is_complete_tree <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  take_into_account_root_edge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num_threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  atol <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  rtol <span class="op">=</span> <span class="fl">1e-07</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"odeint::runge_kutta_cash_karp54"</span>,</span>
<span>  display_warning <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_normalization <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_root_state <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-parameter">parameter<a class="anchor" aria-label="anchor" href="#arg-parameter"></a></dt>
<dd><p>list where first vector represents lambdas, the second
mus and the third transition rates.</p></dd>


<dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>phylogenetic tree of class <code>phylo</code>, rooted and with
branch lengths. Alternatively, multiple phylogenetic trees can be provided
as the <code>multiPhylo</code> class.</p></dd>


<dt id="arg-traits">traits<a class="anchor" aria-label="anchor" href="#arg-traits"></a></dt>
<dd><p>vector with trait states for each tip in the phylogeny. The
order of the states must be the same as the tree tips. For help, see
<code><a href="../articles/starting_secsse.html">vignette("starting_secsse", package = "secsse")</a></code>. When providing a
<code>multiPhylo</code> set of multiple phylognies, traits should be a list where
each entry in the list corresponds to the matching phylogeny on that
position.</p></dd>


<dt id="arg-num-concealed-states">num_concealed_states<a class="anchor" aria-label="anchor" href="#arg-num-concealed-states"></a></dt>
<dd><p>number of concealed states, generally equivalent
to the number of examined states in the dataset.</p></dd>


<dt id="arg-cond">cond<a class="anchor" aria-label="anchor" href="#arg-cond"></a></dt>
<dd><p>condition on the existence of a node root: <code>"maddison_cond"</code>,
<code>"proper_cond"</code> (default). For details, see vignette.</p></dd>


<dt id="arg-root-state-weight">root_state_weight<a class="anchor" aria-label="anchor" href="#arg-root-state-weight"></a></dt>
<dd><p>the method to weigh the states:
<code>"maddison_weights"</code>, <code>"proper_weights"</code> (default) or <code>"equal_weights"</code>.
It can also be specified for the root state: the vector <code>c(1, 0, 0)</code>
indicates state 1 was the root state. When
using a <code>multiPhylo</code> object, root_state_weight should be list where each
entry in the list corresponds to the root_state_weight for each tree.</p></dd>


<dt id="arg-sampling-fraction">sampling_fraction<a class="anchor" aria-label="anchor" href="#arg-sampling-fraction"></a></dt>
<dd><p>vector that states the sampling proportion per
trait state. It must have as many elements as there are trait states. When
using a <code>multiPhylo</code> object, sampling fraction should be list where each
entry in the list corresponds to the sampling proportion for each tree.</p></dd>


<dt id="arg-setting-calculation">setting_calculation<a class="anchor" aria-label="anchor" href="#arg-setting-calculation"></a></dt>
<dd><p>argument used internally to speed up calculation.
This should be left blank (default : <code>setting_calculation = NULL</code>).</p></dd>


<dt id="arg-see-ancestral-states">see_ancestral_states<a class="anchor" aria-label="anchor" href="#arg-see-ancestral-states"></a></dt>
<dd><p>Boolean for whether the ancestral states for each
of the internal nodes should be output. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-loglik-penalty">loglik_penalty<a class="anchor" aria-label="anchor" href="#arg-loglik-penalty"></a></dt>
<dd><p>the size of the penalty for all parameters; default is
0 (no penalty).</p></dd>


<dt id="arg-is-complete-tree">is_complete_tree<a class="anchor" aria-label="anchor" href="#arg-is-complete-tree"></a></dt>
<dd><p>logical specifying whether or not a tree with all its
extinct species is provided. If set to <code>TRUE</code>, it also assumes that all
<em>all</em> extinct lineages are present on the tree. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-take-into-account-root-edge">take_into_account_root_edge<a class="anchor" aria-label="anchor" href="#arg-take-into-account-root-edge"></a></dt>
<dd><p>if TRUE, the LL integration is continued
along the root edge. This also affects conditioning (as now, conditioning
no longer needs to assume a speciation event at the start of the tree)</p></dd>


<dt id="arg-num-threads">num_threads<a class="anchor" aria-label="anchor" href="#arg-num-threads"></a></dt>
<dd><p>number of threads to be used. Default is one thread.</p></dd>


<dt id="arg-atol">atol<a class="anchor" aria-label="anchor" href="#arg-atol"></a></dt>
<dd><p>A numeric specifying the absolute tolerance of integration.</p></dd>


<dt id="arg-rtol">rtol<a class="anchor" aria-label="anchor" href="#arg-rtol"></a></dt>
<dd><p>A numeric specifying the relative tolerance of integration.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>integration method used, available are:
<code>"odeint::runge_kutta_cash_karp54"</code>, <code>"odeint::runge_kutta_fehlberg78"</code>,
<code>"odeint::runge_kutta_dopri5"</code>, <code>"odeint::bulirsch_stoer"</code> and
<code>"odeint::runge_kutta4"</code>. Default method is: <code>"odeint::runge_kutta_cash_karp54"</code>.</p></dd>


<dt id="arg-display-warning">display_warning<a class="anchor" aria-label="anchor" href="#arg-display-warning"></a></dt>
<dd><p>display a warning if necessary</p></dd>


<dt id="arg-use-normalization">use_normalization<a class="anchor" aria-label="anchor" href="#arg-use-normalization"></a></dt>
<dd><p>normalize the density vector during integration,
more accurate but slower (default = TRUE)</p></dd>


<dt id="arg-return-root-state">return_root_state<a class="anchor" aria-label="anchor" href="#arg-return-root-state"></a></dt>
<dd><p>if TRUE, returns the state of the system at the
root, this can be useful to use as the starting point of a simulation. When
used in ML, after finishing the ML optimization, the found optimum is
evaluated one more time to retrieve the root state (to avoid having to
store the root state every ML evaluation).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following elements:
$LL the loglikelihood of the data (phylogeny + tip states) given the
parameters (speciation, extinction, transition rates).
If see_ancestral_states = TRUE, then there will be two additional elements:
$ancestral_states: a matrix with the probabilities of each state at the
internal nodes
$states: a matrix with the probabilities E, D (normalized) and S that are used
in the calculations. The ancestral_states matrix is a submatrix of this matrix.
This matrix is mostly used for package developers.
If return_root_state = TRUE, then there will be one additional element:
$root_state: vector with probabilities of each state at the root. This vector
is the same as the top row of $ancestral_states
We have used the shorthand description of "probabilities of each state",
but technically, the probabilities are the normalized probabilities D of the
data given each state at the internal nodes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsetienne.github.io/secsse/">secsse</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">13</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phylotree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rcoal</a></span><span class="op">(</span><span class="fl">31</span>, tip.label <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">31</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Ntip</a></span><span class="op">(</span><span class="va">phylotree</span><span class="op">)</span>,replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">num_concealed_states</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">cond</span> <span class="op">&lt;-</span> <span class="st">"proper_cond"</span></span></span>
<span class="r-in"><span><span class="va">root_state_weight</span> <span class="op">&lt;-</span> <span class="st">"proper_weights"</span></span></span>
<span class="r-in"><span><span class="va">sampling_fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">drill</span> <span class="op">&lt;-</span> <span class="fu"><a href="id_paramPos.html">id_paramPos</a></span><span class="op">(</span><span class="va">traits</span>,<span class="va">num_concealed_states</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">drill</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.12</span>,<span class="fl">0.01</span>,<span class="fl">0.2</span>,<span class="fl">0.21</span>,<span class="fl">0.31</span>,<span class="fl">0.23</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">drill</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">drill</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">drill</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="fu">secsse_loglik</span><span class="op">(</span>parameter <span class="op">=</span> <span class="va">drill</span>,</span></span>
<span class="r-in"><span><span class="va">phylotree</span>,</span></span>
<span class="r-in"><span><span class="va">traits</span>,</span></span>
<span class="r-in"><span><span class="va">num_concealed_states</span>,</span></span>
<span class="r-in"><span><span class="va">cond</span>,</span></span>
<span class="r-in"><span><span class="va">root_state_weight</span>,</span></span>
<span class="r-in"><span><span class="va">sampling_fraction</span>,</span></span>
<span class="r-in"><span>see_ancestral_states <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Deduced names and order of used states to be: 0, 1, 2</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> if this is incorrect, consider passing states as matching numeric </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   ordering, e.g. 1 for the first state, 2 for the second etc.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -113.0919</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#[1] -113.1018</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leonel Herrera Alsina, Paul van Els, Rampal S. Etienne.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

