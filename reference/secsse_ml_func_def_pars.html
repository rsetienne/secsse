<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Maximum likehood estimation for (SecSSE) complex functions as parameter — secsse_ml_func_def_pars • secsse</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum likehood estimation for (SecSSE) complex functions as parameter — secsse_ml_func_def_pars"><meta name="description" content="Maximum likehood estimation under Several examined and concealed
States-dependent Speciation and Extinction (SecSSE) where some parameters
are functions of other parameters and/or factors."><meta property="og:description" content="Maximum likehood estimation under Several examined and concealed
States-dependent Speciation and Extinction (SecSSE) where some parameters
are functions of other parameters and/or factors."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">secsse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/starting_secsse.html">Starting secsse</a></li>
    <li><a class="dropdown-item" href="../articles/plotting_states.html">Plotting probabilities</a></li>
    <li><a class="dropdown-item" href="../articles/sim_with_secsse.html">Simulating with secsse</a></li>
    <li><a class="dropdown-item" href="../articles/complete_tree.html">Using secsse with complete phylogenies (with extinction)</a></li>
    <li><a class="dropdown-item" href="../articles/secsse_performance.html">Secsse performance</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rsetienne/secsse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Maximum likehood estimation for (SecSSE) complex functions as parameter</h1>
      <small class="dont-index">Source: <a href="https://github.com/rsetienne/secsse/blob/master/R/secsse_ml_func_def_pars.R" class="external-link"><code>R/secsse_ml_func_def_pars.R</code></a></small>
      <div class="d-none name"><code>secsse_ml_func_def_pars.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Maximum likehood estimation under Several examined and concealed
States-dependent Speciation and Extinction (SecSSE) where some parameters
are functions of other parameters and/or factors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">secsse_ml_func_def_pars</span><span class="op">(</span></span>
<span>  <span class="va">phy</span>,</span>
<span>  <span class="va">traits</span>,</span>
<span>  <span class="va">num_concealed_states</span>,</span>
<span>  <span class="va">idparslist</span>,</span>
<span>  <span class="va">idparsopt</span>,</span>
<span>  <span class="va">initparsopt</span>,</span>
<span>  <span class="va">idfactorsopt</span>,</span>
<span>  <span class="va">initfactors</span>,</span>
<span>  <span class="va">idparsfix</span>,</span>
<span>  <span class="va">parsfix</span>,</span>
<span>  <span class="va">idparsfuncdefpar</span>,</span>
<span>  functions_defining_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cond <span class="op">=</span> <span class="st">"proper_cond"</span>,</span>
<span>  root_state_weight <span class="op">=</span> <span class="st">"proper_weights"</span>,</span>
<span>  <span class="va">sampling_fraction</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-04</span>, <span class="fl">1e-05</span>, <span class="fl">1e-07</span><span class="op">)</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idparsopt</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  optimmethod <span class="op">=</span> <span class="st">"simplex"</span>,</span>
<span>  num_cycles <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  loglik_penalty <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  is_complete_tree <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  take_into_account_root_edge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num_threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  atol <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  rtol <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"odeint::runge_kutta_cash_karp54"</span>,</span>
<span>  return_root_state <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>phylogenetic tree of class <code>phylo</code>, rooted and with
branch lengths. Alternatively, multiple phylogenetic trees can be provided
as the <code>multiPhylo</code> class.</p></dd>


<dt id="arg-traits">traits<a class="anchor" aria-label="anchor" href="#arg-traits"></a></dt>
<dd><p>vector with trait states for each tip in the phylogeny. The
order of the states must be the same as the tree tips. For help, see
<code><a href="../articles/starting_secsse.html">vignette("starting_secsse", package = "secsse")</a></code>. When providing a
<code>multiPhylo</code> set of multiple phylognies, traits should be a list where
each entry in the list corresponds to the matching phylogeny on that
position.</p></dd>


<dt id="arg-num-concealed-states">num_concealed_states<a class="anchor" aria-label="anchor" href="#arg-num-concealed-states"></a></dt>
<dd><p>number of concealed states, generally equivalent
to the number of examined states in the dataset.</p></dd>


<dt id="arg-idparslist">idparslist<a class="anchor" aria-label="anchor" href="#arg-idparslist"></a></dt>
<dd><p>overview of parameters and their values.</p></dd>


<dt id="arg-idparsopt">idparsopt<a class="anchor" aria-label="anchor" href="#arg-idparsopt"></a></dt>
<dd><p>a numeric vector with the ID of parameters to be estimated.</p></dd>


<dt id="arg-initparsopt">initparsopt<a class="anchor" aria-label="anchor" href="#arg-initparsopt"></a></dt>
<dd><p>a numeric vector with the initial guess of the parameters
to be estimated.</p></dd>


<dt id="arg-idfactorsopt">idfactorsopt<a class="anchor" aria-label="anchor" href="#arg-idfactorsopt"></a></dt>
<dd><p>id of the factors that will be optimized. There are not
fixed factors, so use a constant within <code>functions_defining_params</code>.</p></dd>


<dt id="arg-initfactors">initfactors<a class="anchor" aria-label="anchor" href="#arg-initfactors"></a></dt>
<dd><p>the initial guess for a factor (it should be set to <code>NULL</code>
when no factors).</p></dd>


<dt id="arg-idparsfix">idparsfix<a class="anchor" aria-label="anchor" href="#arg-idparsfix"></a></dt>
<dd><p>a numeric vector with the ID of the fixed parameters.</p></dd>


<dt id="arg-parsfix">parsfix<a class="anchor" aria-label="anchor" href="#arg-parsfix"></a></dt>
<dd><p>a numeric vector with the value of the fixed parameters.</p></dd>


<dt id="arg-idparsfuncdefpar">idparsfuncdefpar<a class="anchor" aria-label="anchor" href="#arg-idparsfuncdefpar"></a></dt>
<dd><p>id of the parameters which will be a function of
optimized and/or fixed parameters. The order of id should match
<code>functions_defining_params</code>.</p></dd>


<dt id="arg-functions-defining-params">functions_defining_params<a class="anchor" aria-label="anchor" href="#arg-functions-defining-params"></a></dt>
<dd><p>a list of functions. Each element will be a
function which defines a parameter e.g. <code>id_3 &lt;- (id_1 + id_2) / 2</code>. See
example.</p></dd>


<dt id="arg-cond">cond<a class="anchor" aria-label="anchor" href="#arg-cond"></a></dt>
<dd><p>condition on the existence of a node root: <code>"maddison_cond"</code>,
<code>"proper_cond"</code> (default). For details, see vignette.</p></dd>


<dt id="arg-root-state-weight">root_state_weight<a class="anchor" aria-label="anchor" href="#arg-root-state-weight"></a></dt>
<dd><p>the method to weigh the states:
<code>"maddison_weights"</code>, <code>"proper_weights"</code> (default) or <code>"equal_weights"</code>.
It can also be specified for the root state: the vector <code>c(1, 0, 0)</code>
indicates state 1 was the root state. When
using a <code>multiPhylo</code> object, root_state_weight should be list where each
entry in the list corresponds to the root_state_weight for each tree.</p></dd>


<dt id="arg-sampling-fraction">sampling_fraction<a class="anchor" aria-label="anchor" href="#arg-sampling-fraction"></a></dt>
<dd><p>vector that states the sampling proportion per
trait state. It must have as many elements as there are trait states. When
using a <code>multiPhylo</code> object, sampling fraction should be list where each
entry in the list corresponds to the sampling proportion for each tree.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>A numeric vector with the maximum tolerance of the optimization
algorithm. Default is <code>c(1e-04, 1e-05, 1e-05)</code>.</p></dd>


<dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>max number of iterations. Default is
<code>1000 * round((1.25) ^ length(idparsopt))</code>.</p></dd>


<dt id="arg-optimmethod">optimmethod<a class="anchor" aria-label="anchor" href="#arg-optimmethod"></a></dt>
<dd><p>A string with method used for optimization. Default is
<code>"simplex"</code>. Alternative is <code>"subplex"</code>. Both are called from
<code><a href="https://rsetienne.github.io/DDD/reference/optimizer.html" class="external-link">DDD::optimizer()</a></code>, simplex is implemented natively in <span class="pkg">DDD</span>, while subplex
is ultimately called from <code><a href="https://rdrr.io/pkg/subplex/man/subplex.html" class="external-link">subplex::subplex()</a></code>.</p></dd>


<dt id="arg-num-cycles">num_cycles<a class="anchor" aria-label="anchor" href="#arg-num-cycles"></a></dt>
<dd><p>Number of cycles of the optimization. When set to <code>Inf</code>,
the optimization will be repeated until the result is, within the
tolerance, equal to the starting values, with a maximum of 10 cycles.</p></dd>


<dt id="arg-loglik-penalty">loglik_penalty<a class="anchor" aria-label="anchor" href="#arg-loglik-penalty"></a></dt>
<dd><p>the size of the penalty for all parameters; default is
0 (no penalty).</p></dd>


<dt id="arg-is-complete-tree">is_complete_tree<a class="anchor" aria-label="anchor" href="#arg-is-complete-tree"></a></dt>
<dd><p>logical specifying whether or not a tree with all its
extinct species is provided. If set to <code>TRUE</code>, it also assumes that all
<em>all</em> extinct lineages are present on the tree. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-take-into-account-root-edge">take_into_account_root_edge<a class="anchor" aria-label="anchor" href="#arg-take-into-account-root-edge"></a></dt>
<dd><p>if TRUE, the LL integration is continued
along the root edge. This also affects conditioning (as now, conditioning
no longer needs to assume a speciation event at the start of the tree)</p></dd>


<dt id="arg-num-threads">num_threads<a class="anchor" aria-label="anchor" href="#arg-num-threads"></a></dt>
<dd><p>number of threads to be used. Default is one thread.</p></dd>


<dt id="arg-atol">atol<a class="anchor" aria-label="anchor" href="#arg-atol"></a></dt>
<dd><p>A numeric specifying the absolute tolerance of integration.</p></dd>


<dt id="arg-rtol">rtol<a class="anchor" aria-label="anchor" href="#arg-rtol"></a></dt>
<dd><p>A numeric specifying the relative tolerance of integration.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>ODE integration method. Choose from:
<code>"odeint::runge_kutta_cash_karp54"</code>, <code>"odeint::runge_kutta_fehlberg78"</code>,
<code>"odeint::runge_kutta_dopri5"</code>, <code>"odeint::bulirsch_stoer"</code> and
<code>"odeint::runge_kutta4"</code>. Default method is: <code>"odeint::runge_kutta_cash_karp54"</code>.</p></dd>


<dt id="arg-return-root-state">return_root_state<a class="anchor" aria-label="anchor" href="#arg-return-root-state"></a></dt>
<dd><p>if TRUE, returns the state of the system at the
root, this can be useful to use as the starting point of a simulation. When
used in ML, after finishing the ML optimization, the found optimum is
evaluated one more time to retrieve the root state (to avoid having to
store the root state every ML evaluation).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Parameter estimates and maximum likelihood</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example of how to set the arguments for an ML search. The ML search is stopped</span></span></span>
<span class="r-in"><span><span class="co"># after 10 iterations to keep run time short.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsetienne.github.io/secsse/">secsse</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsetienne.github.io/DDD/" class="external-link">DDD</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phylotree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rlineage.html" class="external-link">rbdtree</a></span><span class="op">(</span><span class="fl">0.07</span>,<span class="fl">0.001</span>,Tmax<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">startingpoint</span><span class="op">&lt;-</span><span class="fu"><a href="https://rsetienne.github.io/DDD/reference/bd_ML.html" class="external-link">bd_ML</a></span><span class="op">(</span>brts <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html" class="external-link">branching.times</a></span><span class="op">(</span><span class="va">phylotree</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> You are optimizing lambda0 mu0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> You are fixing lambda1 mu1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimizing the likelihood - this may take a while. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The loglikelihood for the initial parameter values is -106.425581129189.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.1 0.05 -106.425581129189 initial </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.090134529147982 0.0537544696066746 -105.907164659399 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.090134529147982 0.0537544696066746 -105.907164659399 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.090134529147982 0.0537544696066746 -105.907164659399 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.0828507795100222 0.0525 -105.824147025887 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.0876957494407158 0.05 -105.783359852731 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 0.0756637168141592 0.0462721893491124 -105.702009387679 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 0.0792452830188678 0.0395061728395062 -105.427240145262 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 0.0792452830188678 0.0395061728395062 -105.427240145262 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.0685714285714284 0.0209006928406466 -104.954532462709 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.0685714285714284 0.0209006928406466 -104.954532462709 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 0.0665204277488344 0.00910258239406473 -104.839232262949 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 0.0581066376496188 0.00294951786727165 -104.62976274662 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 0.0581066376496188 0.00294951786727165 -104.62976274662 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 0.0581066376496188 0.00294951786727165 -104.62976274662 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 0.0581066376496188 0.00294951786727165 -104.62976274662 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 0.0581066376496188 0.00294951786727165 -104.62976274662 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 0.0581066376496188 0.00294951786727165 -104.62976274662 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 0.0581066376496188 0.00294951786727165 -104.62976274662 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 0.0581066376496188 0.00294951786727165 -104.62976274662 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 0.0581066376496188 0.00294951786727165 -104.62976274662 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 0.0581066376496188 0.00294951786727165 -104.62976274662 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 0.0579203041153689 0.000953362994805256 -104.608294411085 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 0.0579203041153689 0.000953362994805256 -104.608294411085 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 0.0579203041153689 0.000953362994805256 -104.608294411085 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 0.0569185700009541 0.000733154024100243 -104.601565921372 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 0.0569185700009541 0.000733154024100243 -104.601565921372 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 0.0569185700009541 0.000733154024100243 -104.601565921372 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 0.0567732085054733 5.15034386826397e-05 -104.593729444779 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 0.0567732085054733 5.15034386826397e-05 -104.593729444779 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 0.0567732085054733 5.15034386826397e-05 -104.593729444779 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 0.0564072277699549 1.16314076479027e-05 -104.592993248356 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 0.0564072277699549 1.16314076479027e-05 -104.592993248356 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 0.0564072277699549 1.16314076479027e-05 -104.592993248356 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 0.0564072277699549 1.16314076479027e-05 -104.592993248356 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 0.0564072277699549 1.16314076479027e-05 -104.592993248356 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 0.0564072277699549 1.16314076479027e-05 -104.592993248356 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 0.0564072277699549 1.16314076479027e-05 -104.592993248356 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 0.0564072277699549 1.16314076479027e-05 -104.592993248356 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 0.0566031943033848 5.26275596158352e-06 -104.592948906985 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 0.0566031943033848 5.26275596158352e-06 -104.592948906985 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 0.0566031943033848 5.26275596158352e-06 -104.592948906985 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 0.0564717106877172 3.06528647061127e-06 -104.592865779747 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 0.0564717106877172 3.06528647061127e-06 -104.592865779747 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 0.0564717106877172 3.06528647061127e-06 -104.592865779747 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 0.0565369808069373 5.39732631051912e-07 -104.592847596263 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 0.0565369808069373 5.39732631051912e-07 -104.592847596263 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48 0.0564877157586484 1.77106711409237e-08 -104.592829553347 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49 0.0564877157586484 1.77106711409237e-08 -104.592829553347 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 0.0564877157586484 1.77106711409237e-08 -104.592829553347 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51 0.0564877157586484 1.77106711409237e-08 -104.592829553347 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52 0.0564877157586484 1.77106711409237e-08 -104.592829553347 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53 0.0564877157586484 1.77106711409237e-08 -104.592829553347 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54 0.0564877157586484 1.77106711409237e-08 -104.592829553347 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55 0.0564877157586484 1.77106711409237e-08 -104.592829553347 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56 0.0564877157586484 1.77106711409237e-08 -104.592829553347 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57 0.0564877157586484 1.77106711409237e-08 -104.592829553347 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58 0.0564877157586484 1.77106711409237e-08 -104.592829553347 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59 0.0564877157586484 1.77106711409237e-08 -104.592829553347 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60 0.0564877157586484 1.77106711409237e-08 -104.592829553347 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61 0.0564877157586484 1.77106711409237e-08 -104.592829553347 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62 0.0564787828875198 9.44968080415927e-09 -104.592829468775 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63 0.0564787828875198 9.44968080415927e-09 -104.592829468775 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64 0.0564787828875198 9.44968080415927e-09 -104.592829468775 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65 0.0564842332801909 1.66558900374773e-08 -104.592829465403 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66 0.056480297387231 4.35303382301016e-09 -104.592829359687 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67 0.056480297387231 4.35303382301016e-09 -104.592829359687 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68 0.056480297387231 4.35303382301016e-09 -104.592829359687 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69 0.056480297387231 4.35303382301016e-09 -104.592829359687 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70 0.0564805246767246 1.99140315115161e-09 -104.592829326339 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71 0.0564805246767246 1.99140315115161e-09 -104.592829326339 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72 0.0564833919317324 4.11848852619872e-09 -104.592829316166 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73 0.0564833919317324 4.11848852619872e-09 -104.592829316166 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74 0.0564818708911459 1.30326827848874e-09 -104.592829293202 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75 0.0564818708911459 1.30326827848874e-09 -104.592829293202 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76 0.056483217108998 6.15133406772924e-10 -104.592829275411 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77 0.056483217108998 6.15133406772924e-10 -104.592829275411 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78 0.056483217108998 6.15133406772924e-10 -104.592829275411 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79 0.056483217108998 6.15133406772924e-10 -104.592829275411 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80 0.056483217108998 6.15133406772924e-10 -104.592829275411 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81 0.056483217108998 6.15133406772924e-10 -104.592829275411 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82 0.0564836455885223 3.39975282354587e-10 -104.592829272312 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83 0.0564829739829893 6.57753981152692e-11 -104.592829269624 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84 0.0564829739829893 6.57753981152692e-11 -104.592829269624 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85 0.0564829739829893 6.57753981152692e-11 -104.592829269624 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86 0.0564829739829893 6.57753981152692e-11 -104.592829269624 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87 0.0564829739829893 6.57753981152692e-11 -104.592829269624 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88 0.0564829739829893 6.57753981152692e-11 -104.592829269624 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89 0.0564834791538976 6.1041849912291e-11 -104.592829268828 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90 0.0564834791538976 6.1041849912291e-11 -104.592829268828 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91 0.0564834791538976 6.1041849912291e-11 -104.592829268828 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92 0.0564834791538976 6.1041849912291e-11 -104.592829268828 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93 0.0564834404619696 6.30926800524269e-13 -104.592829268103 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110 0.0564834404619696 6.30926800524269e-13 -104.592829268103 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111 0.0564834411366911 1.0121875039335e-14 -104.592829268096 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 125 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 126 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 127 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 128 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 129 0.0564834411366911 1.0121875039335e-14 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 130 0.0564834411466793 1.05558453530427e-15 -104.592829268096 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 131 0.0564834411466793 1.05558453530427e-15 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 132 0.0564834411466793 1.05558453530427e-15 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 133 0.0564834411466793 1.05558453530427e-15 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 134 0.0564834411466793 1.05558453530427e-15 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 135 0.0564834411466793 1.05558453530427e-15 -104.592829268096 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 136 0.0564834411466793 1.05558453530427e-15 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 137 0.0564834411466793 1.05558453530427e-15 -104.592829268096 shrink </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 138 0.0564834411466793 1.05558453530427e-15 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 139 0.0564834411466793 1.05558453530427e-15 -104.592829268096 shrink </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 140 0.0564834411466793 1.05558453530427e-15 -104.592829268096 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 141 0.0564834411466793 1.05558453530427e-15 -104.592829268096 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 142 0.0564834411466793 1.05558453530427e-15 -104.592829268096 shrink </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 143 0.0564834411466793 1.05558453530427e-15 -104.592829268096 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 144 0.0564834411465597 1.1641772011865e-15 -104.592829268096 shrink </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 145 0.0564834411465597 1.1641772011865e-15 -104.592829268096 shrink </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 146 0.0564834411465597 1.1641772011865e-15 -104.592829268096 shrink </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 147 0.0564834411465597 1.1641772011865e-15 -104.592829268096 shrink </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 148 0.0564834411465597 1.1641772011865e-15 -104.592829268096 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 149 0.0564834411465597 1.1641772011865e-15 -104.592829268096 shrink </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 150 0.0564834411465597 1.1641772011865e-15 -104.592829268096 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 151 0.0564834411465597 1.1641772011865e-15 -104.592829268096 shrink </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 152 0.0564834411465597 1.1641772011865e-15 -104.592829268096 shrink </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 153 0.0564834411465597 1.1641772011865e-15 -104.592829268096 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 154 0.0564834411465597 1.1641772011865e-15 -104.592829268096 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization has terminated successfully. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum likelihood parameter estimates: lambda0: 0.056483, mu0: 0.000000, lambda1: 0.000000, mu1: 0.000000: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum loglikelihood: -104.592829</span>
<span class="r-in"><span><span class="va">intGuessLamba</span> <span class="op">&lt;-</span> <span class="va">startingpoint</span><span class="op">$</span><span class="va">lambda0</span></span></span>
<span class="r-in"><span><span class="va">intGuessMu</span> <span class="op">&lt;-</span> <span class="va">startingpoint</span><span class="op">$</span><span class="va">mu0</span></span></span>
<span class="r-in"><span><span class="va">traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Ntip</a></span><span class="op">(</span><span class="va">phylotree</span><span class="op">)</span>,replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co">#get some traits</span></span></span>
<span class="r-in"><span><span class="va">num_concealed_states</span><span class="op">&lt;-</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">&lt;-</span><span class="fu"><a href="id_paramPos.html">id_paramPos</a></span><span class="op">(</span><span class="va">traits</span>, <span class="va">num_concealed_states</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">masterBlock</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">5</span><span class="op">)</span>,ncol <span class="op">=</span> <span class="fl">3</span>,nrow <span class="op">=</span> <span class="fl">3</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">masterBlock</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">diff.conceal</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="q_doubletrans.html">q_doubletrans</a></span><span class="op">(</span><span class="va">traits</span>,<span class="va">masterBlock</span>,<span class="va">diff.conceal</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idparsfuncdefpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idparsopt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idparsfix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">initparsopt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">intGuessLamba</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">parsfix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idfactorsopt</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">initfactors</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="co"># functions_defining_params is a list of functions. Each function has no</span></span></span>
<span class="r-in"><span><span class="co"># arguments and to refer</span></span></span>
<span class="r-in"><span><span class="co"># to parameters ids should be indicated as "par_" i.e. par_3 refers to</span></span></span>
<span class="r-in"><span><span class="co"># parameter 3. When a function is defined, be sure that all the parameters</span></span></span>
<span class="r-in"><span><span class="co"># involved are either estimated, fixed or</span></span></span>
<span class="r-in"><span><span class="co"># defined by previous functions (i.e, a function that defines parameter in</span></span></span>
<span class="r-in"><span><span class="co"># 'functions_defining_params'). The user is responsible for this. In this</span></span></span>
<span class="r-in"><span><span class="co"># exampl3, par_3 (i.e., parameter 3) is needed to calculate par_6. This is</span></span></span>
<span class="r-in"><span><span class="co"># correct because par_3 is defined in</span></span></span>
<span class="r-in"><span><span class="co"># the first function of 'functions_defining_params'. Notice that factor_1</span></span></span>
<span class="r-in"><span><span class="co"># indicates a value that will be estimated to satisfy the equation. The same</span></span></span>
<span class="r-in"><span><span class="co"># factor can be shared to define several parameters.</span></span></span>
<span class="r-in"><span><span class="va">functions_defining_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">functions_defining_params</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="va">par_3</span> <span class="op">&lt;-</span> <span class="va">par_1</span> <span class="op">+</span> <span class="va">par_2</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">functions_defining_params</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="va">par_5</span> <span class="op">&lt;-</span> <span class="va">par_1</span> <span class="op">*</span> <span class="va">factor_1</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">functions_defining_params</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="va">par_6</span> <span class="op">&lt;-</span> <span class="va">par_3</span> <span class="op">*</span> <span class="va">factor_1</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tol</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-03</span>, <span class="fl">1e-03</span>, <span class="fl">1e-03</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">optimmethod</span> <span class="op">=</span> <span class="st">"simplex"</span></span></span>
<span class="r-in"><span><span class="va">cond</span><span class="op">&lt;-</span><span class="st">"proper_cond"</span></span></span>
<span class="r-in"><span><span class="va">root_state_weight</span> <span class="op">&lt;-</span> <span class="st">"proper_weights"</span></span></span>
<span class="r-in"><span><span class="va">sampling_fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">maxiter</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">secsse_ml_func_def_pars</span><span class="op">(</span><span class="va">phylotree</span>,</span></span>
<span class="r-in"><span><span class="va">traits</span>,</span></span>
<span class="r-in"><span><span class="va">num_concealed_states</span>,</span></span>
<span class="r-in"><span><span class="va">idparslist</span>,</span></span>
<span class="r-in"><span><span class="va">idparsopt</span>,</span></span>
<span class="r-in"><span><span class="va">initparsopt</span>,</span></span>
<span class="r-in"><span><span class="va">idfactorsopt</span>,</span></span>
<span class="r-in"><span><span class="va">initfactors</span>,</span></span>
<span class="r-in"><span><span class="va">idparsfix</span>,</span></span>
<span class="r-in"><span><span class="va">parsfix</span>,</span></span>
<span class="r-in"><span><span class="va">idparsfuncdefpar</span>,</span></span>
<span class="r-in"><span><span class="va">functions_defining_params</span>,</span></span>
<span class="r-in"><span><span class="va">cond</span>,</span></span>
<span class="r-in"><span><span class="va">root_state_weight</span>,</span></span>
<span class="r-in"><span><span class="va">sampling_fraction</span>,</span></span>
<span class="r-in"><span><span class="va">tol</span>,</span></span>
<span class="r-in"><span><span class="va">maxiter</span>,</span></span>
<span class="r-in"><span><span class="va">optimmethod</span>,</span></span>
<span class="r-in"><span>num_cycles <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: you set some transitions as impossible to happen.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Optimization has not converged. Try again with different initial values or increase the number of iterations.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">ML</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span><span class="co"># ML -136.45265 if run till completion</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leonel Herrera Alsina, Paul van Els, Rampal S. Etienne.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

