<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Maximum likehood estimation for (SecSSE) — secsse_ml • secsse</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum likehood estimation for (SecSSE) — secsse_ml"><meta name="description" content="Maximum likehood estimation under Several examined and concealed
trait States dependent Speciation and Extinction (SecSSE)"><meta property="og:description" content="Maximum likehood estimation under Several examined and concealed
trait States dependent Speciation and Extinction (SecSSE)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">secsse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/starting_secsse.html">Starting secsse</a></li>
    <li><a class="dropdown-item" href="../articles/plotting_states.html">Plotting probabilities</a></li>
    <li><a class="dropdown-item" href="../articles/sim_with_secsse.html">Simulating with secsse</a></li>
    <li><a class="dropdown-item" href="../articles/complete_tree.html">Using secsse with complete phylogenies (with extinction)</a></li>
    <li><a class="dropdown-item" href="../articles/secsse_performance.html">Secsse performance</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rsetienne/secsse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Maximum likehood estimation for (SecSSE)</h1>
      <small class="dont-index">Source: <a href="https://github.com/rsetienne/secsse/blob/master/R/secsse_ml.R" class="external-link"><code>R/secsse_ml.R</code></a></small>
      <div class="d-none name"><code>secsse_ml.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Maximum likehood estimation under Several examined and concealed
trait States dependent Speciation and Extinction (SecSSE)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">secsse_ml</span><span class="op">(</span></span>
<span>  <span class="va">phy</span>,</span>
<span>  <span class="va">traits</span>,</span>
<span>  <span class="va">num_concealed_states</span>,</span>
<span>  <span class="va">idparslist</span>,</span>
<span>  <span class="va">idparsopt</span>,</span>
<span>  <span class="va">initparsopt</span>,</span>
<span>  <span class="va">idparsfix</span>,</span>
<span>  <span class="va">parsfix</span>,</span>
<span>  cond <span class="op">=</span> <span class="st">"proper_cond"</span>,</span>
<span>  root_state_weight <span class="op">=</span> <span class="st">"proper_weights"</span>,</span>
<span>  <span class="va">sampling_fraction</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-04</span>, <span class="fl">1e-05</span>, <span class="fl">1e-07</span><span class="op">)</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idparsopt</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  optimmethod <span class="op">=</span> <span class="st">"simplex"</span>,</span>
<span>  num_cycles <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  loglik_penalty <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  is_complete_tree <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  take_into_account_root_edge <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num_threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  atol <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  rtol <span class="op">=</span> <span class="fl">1e-07</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"odeint::runge_kutta_cash_karp54"</span>,</span>
<span>  use_normalization <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_root_state <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  see_ancestral_states <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>phylogenetic tree of class <code>phylo</code>, rooted and with
branch lengths. Alternatively, multiple phylogenetic trees can be provided
as the <code>multiPhylo</code> class.</p></dd>


<dt id="arg-traits">traits<a class="anchor" aria-label="anchor" href="#arg-traits"></a></dt>
<dd><p>vector with trait states for each tip in the phylogeny. The
order of the states must be the same as the tree tips. For help, see
<code><a href="../articles/starting_secsse.html">vignette("starting_secsse", package = "secsse")</a></code>. When providing a
<code>multiPhylo</code> set of multiple phylognies, traits should be a list where
each entry in the list corresponds to the matching phylogeny on that
position.</p></dd>


<dt id="arg-num-concealed-states">num_concealed_states<a class="anchor" aria-label="anchor" href="#arg-num-concealed-states"></a></dt>
<dd><p>number of concealed states, generally equivalent
to the number of examined states in the dataset.</p></dd>


<dt id="arg-idparslist">idparslist<a class="anchor" aria-label="anchor" href="#arg-idparslist"></a></dt>
<dd><p>overview of parameters and their values.</p></dd>


<dt id="arg-idparsopt">idparsopt<a class="anchor" aria-label="anchor" href="#arg-idparsopt"></a></dt>
<dd><p>a numeric vector with the ID of parameters to be estimated.</p></dd>


<dt id="arg-initparsopt">initparsopt<a class="anchor" aria-label="anchor" href="#arg-initparsopt"></a></dt>
<dd><p>a numeric vector with the initial guess of the parameters
to be estimated.</p></dd>


<dt id="arg-idparsfix">idparsfix<a class="anchor" aria-label="anchor" href="#arg-idparsfix"></a></dt>
<dd><p>a numeric vector with the ID of the fixed parameters.</p></dd>


<dt id="arg-parsfix">parsfix<a class="anchor" aria-label="anchor" href="#arg-parsfix"></a></dt>
<dd><p>a numeric vector with the value of the fixed parameters.</p></dd>


<dt id="arg-cond">cond<a class="anchor" aria-label="anchor" href="#arg-cond"></a></dt>
<dd><p>condition on the existence of a node root: <code>"maddison_cond"</code>,
<code>"proper_cond"</code> (default). For details, see vignette.</p></dd>


<dt id="arg-root-state-weight">root_state_weight<a class="anchor" aria-label="anchor" href="#arg-root-state-weight"></a></dt>
<dd><p>the method to weigh the states:
<code>"maddison_weights"</code>, <code>"proper_weights"</code> (default) or <code>"equal_weights"</code>.
It can also be specified for the root state: the vector <code>c(1, 0, 0)</code>
indicates state 1 was the root state. When
using a <code>multiPhylo</code> object, root_state_weight should be list where each
entry in the list corresponds to the root_state_weight for each tree.</p></dd>


<dt id="arg-sampling-fraction">sampling_fraction<a class="anchor" aria-label="anchor" href="#arg-sampling-fraction"></a></dt>
<dd><p>vector that states the sampling proportion per
trait state. It must have as many elements as there are trait states. When
using a <code>multiPhylo</code> object, sampling fraction should be list where each
entry in the list corresponds to the sampling proportion for each tree.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>A numeric vector with the maximum tolerance of the optimization
algorithm. Default is <code>c(1e-04, 1e-05, 1e-05)</code>.</p></dd>


<dt id="arg-maxiter">maxiter<a class="anchor" aria-label="anchor" href="#arg-maxiter"></a></dt>
<dd><p>max number of iterations. Default is
<code>1000 * round((1.25) ^ length(idparsopt))</code>.</p></dd>


<dt id="arg-optimmethod">optimmethod<a class="anchor" aria-label="anchor" href="#arg-optimmethod"></a></dt>
<dd><p>A string with method used for optimization. Default is
<code>"simplex"</code>. Alternative is <code>"subplex"</code>. Both are called from
<code><a href="https://rsetienne.github.io/DDD/reference/optimizer.html" class="external-link">DDD::optimizer()</a></code>, simplex is implemented natively in <span class="pkg">DDD</span>, while subplex
is ultimately called from <code><a href="https://rdrr.io/pkg/subplex/man/subplex.html" class="external-link">subplex::subplex()</a></code>.</p></dd>


<dt id="arg-num-cycles">num_cycles<a class="anchor" aria-label="anchor" href="#arg-num-cycles"></a></dt>
<dd><p>Number of cycles of the optimization. When set to <code>Inf</code>,
the optimization will be repeated until the result is, within the
tolerance, equal to the starting values, with a maximum of 10 cycles.</p></dd>


<dt id="arg-loglik-penalty">loglik_penalty<a class="anchor" aria-label="anchor" href="#arg-loglik-penalty"></a></dt>
<dd><p>the size of the penalty for all parameters; default is
0 (no penalty).</p></dd>


<dt id="arg-is-complete-tree">is_complete_tree<a class="anchor" aria-label="anchor" href="#arg-is-complete-tree"></a></dt>
<dd><p>logical specifying whether or not a tree with all its
extinct species is provided. If set to <code>TRUE</code>, it also assumes that all
<em>all</em> extinct lineages are present on the tree. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-take-into-account-root-edge">take_into_account_root_edge<a class="anchor" aria-label="anchor" href="#arg-take-into-account-root-edge"></a></dt>
<dd><p>if TRUE, the LL integration is continued
along the root edge. This also affects conditioning (as now, conditioning
no longer needs to assume a speciation event at the start of the tree)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>sets verbose output; default is <code>TRUE</code> when <code>optimmethod</code> is
<code>"simplex"</code>. If <code>optimmethod</code> is set to <code>"simplex"</code>, then even if set to
<code>FALSE</code>, optimizer output will be shown.</p></dd>


<dt id="arg-num-threads">num_threads<a class="anchor" aria-label="anchor" href="#arg-num-threads"></a></dt>
<dd><p>number of threads to be used. Default is one thread.</p></dd>


<dt id="arg-atol">atol<a class="anchor" aria-label="anchor" href="#arg-atol"></a></dt>
<dd><p>A numeric specifying the absolute tolerance of integration.</p></dd>


<dt id="arg-rtol">rtol<a class="anchor" aria-label="anchor" href="#arg-rtol"></a></dt>
<dd><p>A numeric specifying the relative tolerance of integration.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>integration method used, available are:
<code>"odeint::runge_kutta_cash_karp54"</code>, <code>"odeint::runge_kutta_fehlberg78"</code>,
<code>"odeint::runge_kutta_dopri5"</code>, <code>"odeint::bulirsch_stoer"</code> and
<code>"odeint::runge_kutta4"</code>. Default method is: <code>"odeint::runge_kutta_cash_karp54"</code>.</p></dd>


<dt id="arg-use-normalization">use_normalization<a class="anchor" aria-label="anchor" href="#arg-use-normalization"></a></dt>
<dd><p>normalize the density vector during integration,
more accurate but slower (default = TRUE)</p></dd>


<dt id="arg-return-root-state">return_root_state<a class="anchor" aria-label="anchor" href="#arg-return-root-state"></a></dt>
<dd><p>if TRUE, returns the state of the system at the
root, this can be useful to use as the starting point of a simulation. When
used in ML, after finishing the ML optimization, the found optimum is
evaluated one more time to retrieve the root state (to avoid having to
store the root state every ML evaluation).</p></dd>


<dt id="arg-see-ancestral-states">see_ancestral_states<a class="anchor" aria-label="anchor" href="#arg-see-ancestral-states"></a></dt>
<dd><p>Boolean for whether the ancestral states for each
of the internal nodes should be output. Defaults to <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following elements
$MLpars: the maximum likelihood parameter estimates
$ML: the maximum likelihood of the data (phylogeny + tip states) given the
parameters (speciation, extinction, transition rates).
$conv: whether the optimization converged or not
If see_ancestral_states = TRUE, then there will be two additional elements:
$ancestral_states: a matrix with the probabilities of each state at the
internal nodes
$states: a matrix with the probabilities E, D (normalized) and S that are used
in the calculations. The ancestral_states matrix is a submatrix of this matrix.
This matrix is mostly used for package developers.
If return_root_state = TRUE, then there will be one additional element:
$root_state: vector with probabilities of each state at the root. This vector
is the same as the top row of $ancestral_states
We have used the shorthand description of "probabilities of each state",
but technically, the probabilities are the normalized probabilities D of the
data given each state at the internal nodes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example of how to set the arguments for a ML search.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsetienne.github.io/secsse/">secsse</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsetienne.github.io/DDD/" class="external-link">DDD</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">13</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># lambdas for 0A and 1A and 2A are the same but need to be estimated</span></span></span>
<span class="r-in"><span><span class="co"># mus are fixed to</span></span></span>
<span class="r-in"><span><span class="co"># the transition rates are constrained to be equal and fixed 0.01</span></span></span>
<span class="r-in"><span><span class="va">phylotree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rcoal</a></span><span class="op">(</span><span class="fl">31</span>, tip.label <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">31</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">traits</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/summary.phylo.html" class="external-link">Ntip</a></span><span class="op">(</span><span class="va">phylotree</span><span class="op">)</span>,replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="co">#get some traits</span></span></span>
<span class="r-in"><span><span class="va">num_concealed_states</span><span class="op">&lt;-</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span> <span class="op">&lt;-</span> <span class="fu"><a href="id_paramPos.html">id_paramPos</a></span><span class="op">(</span><span class="va">traits</span>, <span class="va">num_concealed_states</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">masterBlock</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">5</span>,ncol <span class="op">=</span> <span class="fl">3</span>,nrow <span class="op">=</span> <span class="fl">3</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">masterBlock</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">diff.conceal</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="va">idparslist</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="q_doubletrans.html">q_doubletrans</a></span><span class="op">(</span><span class="va">traits</span>,<span class="va">masterBlock</span>,<span class="va">diff.conceal</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">startingpoint</span> <span class="op">&lt;-</span> <span class="fu">DDD</span><span class="fu">::</span><span class="fu"><a href="https://rsetienne.github.io/DDD/reference/bd_ML.html" class="external-link">bd_ML</a></span><span class="op">(</span>brts <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html" class="external-link">branching.times</a></span><span class="op">(</span><span class="va">phylotree</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> You are optimizing lambda0 mu0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> You are fixing lambda1 mu1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimizing the likelihood - this may take a while. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The loglikelihood for the initial parameter values is -67.5669039297515.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.1 0.05 -67.5669039297515 initial </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.10751708428246 0.0450354609929078 -65.4917085799141 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.118987341772152 0.0425707547169811 -62.6116799074596 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.130040674026729 0.0316219369894982 -60.0623957590543 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.16003578884581 0.0214904679376082 -54.1880637307688 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.171919252786984 0.0109777015437391 -52.1459129951388 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 0.20421052631579 0.00124575311438257 -47.3167705826442 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 0.20421052631579 0.00124575311438257 -47.3167705826442 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 0.224058848983124 0.000466793974113919 -44.7449478078427 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.224058848983124 0.000466793974113919 -44.7449478078427 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.224058848983124 0.000466793974113919 -44.7449478078427 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 0.224058848983124 0.000466793974113919 -44.7449478078427 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 0.241585109022692 0.00187733366385477 -42.6722136437239 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 0.241585109022692 0.00187733366385477 -42.6722136437239 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 0.245063027607108 0.000534793931928738 -42.2744067243519 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 0.283725124695804 0.002686531706008 -38.268404787894 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 0.311666925320418 0.00107428358172823 -35.7092732077242 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 0.417006504462819 0.00458056624685354 -27.9166533594376 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 0.552345063361616 0.00310013051989255 -20.5841775642041 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 0.999710978419122 0.00941693450855305 -6.11082263685136 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 2.27909404225444 0.00960139832193025 10.0151263830053 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 5.21705445573082 0.0160006094561096 16.1785096523468 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 5.21705445573082 0.0160006094561096 16.1785096523468 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 5.01998823368004 0.0136379132713058 16.2560080596617 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 5.01998823368004 0.0136379132713058 16.2560080596617 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 5.01998823368004 0.0136379132713058 16.2560080596617 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 5.01998823368004 0.0136379132713058 16.2560080596617 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 4.55446419871381 0.0128534405447574 16.2631263946886 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 4.64588795177035 0.0137039945459958 16.2848709659965 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 4.80229839456717 0.0134581943044441 16.2937332389957 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 4.81120051567174 0.0139452912078601 16.2940812796361 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 4.81120051567174 0.0139452912078601 16.2940812796361 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 4.76567827800176 0.0137022618170484 16.2947894537823 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 4.76065312690264 0.0145556889964371 16.2960740367271 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 4.76065312690264 0.0145556889964371 16.2960740367271 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 4.79022620079006 0.0154864548902051 16.2973233277974 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 4.75218055478964 0.0169942434321319 16.2997041566054 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 4.79223074981811 0.0196248205710623 16.3037561005318 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 4.73629313942515 0.0239978850776008 16.3099408464347 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 4.78816706953557 0.0315694753860139 16.3225147746448 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 4.70280849451185 0.0444562799202822 16.3386546709549 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 4.76300865274624 0.0670993241803681 16.3772660505063 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43 4.62504104143953 0.107370095721328 16.4187629975376 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44 4.67404733819262 0.182915943276343 16.5392504556424 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45 4.43521596124657 0.336230605439469 16.6473252817553 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46 4.41164804858929 0.710768233889407 17.0706425877938 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47 3.98316180283265 2.24020350664308 17.2171748932065 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48 3.98316180283265 2.24020350664308 17.2171748932065 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49 4.07346035699536 2.38203955173376 17.4662453522485 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 4.07346035699536 2.38203955173376 17.4662453522485 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51 4.31161638009175 1.32342613753295 17.5226302331618 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52 4.16709185895139 2.53686144433066 17.7154198744796 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53 4.41433359817449 1.3954628618119 17.7185736950648 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54 4.26424430847961 2.70653812576365 17.9642758896243 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55 4.26424430847961 2.70653812576365 17.9642758896243 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56 4.36512011550272 2.89331525059336 18.2120603942574 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57 4.36512011550272 2.89331525059336 18.2120603942574 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58 4.66136773871767 1.88546289068739 18.3961601459291 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59 4.70648903260947 3.21428499862903 18.9854345168409 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60 4.70648903260947 3.21428499862903 18.9854345168409 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61 5.09425066821065 3.5929320228858 19.7460720492775 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62 5.09425066821065 3.5929320228858 19.7460720492775 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63 5.80189742917594 2.73281194988049 19.891495086665 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64 6.6039561842407 4.74973441119815 21.7148252295986 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65 6.6039561842407 4.74973441119815 21.7148252295986 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66 7.98114599108672 6.78056785143906 23.1538234475791 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67 7.98114599108672 6.78056785143906 23.1538234475791 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68 7.98114599108672 6.78056785143906 23.1538234475791 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69 7.98114599108672 6.78056785143906 23.1538234475791 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70 7.98114599108672 6.78056785143906 23.1538234475791 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71 10.1395538920206 8.45171163553439 23.9139163249958 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72 10.1395538920206 8.45171163553439 23.9139163249958 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73 13.8199382485835 15.2298157008651 24.8174728317274 expand </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74 13.8199382485835 15.2298157008651 24.8174728317274 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75 13.8199382485835 15.2298157008651 24.8174728317274 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76 15.4285564045627 16.0830170757239 25.2469358976012 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77 15.4285564045627 16.0830170757239 25.2469358976012 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78 15.4285564045627 16.0830170757239 25.2469358976012 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79 15.4285564045627 16.0830170757239 25.2469358976012 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80 14.9726890772342 14.9063686208314 25.2528175353109 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81 16.2514277486149 16.6500060792838 25.2706584263598 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82 15.5076209515346 15.9061391050424 25.2791276917661 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83 15.5076209515346 15.9061391050424 25.2791276917661 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84 15.8456501667037 16.1784190497506 25.2798613824538 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85 15.5412562982367 15.7972482423416 25.2820875172611 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86 15.5412562982367 15.7972482423416 25.2820875172611 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87 15.5412562982367 15.7972482423416 25.2820875172611 reflect </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88 15.5099956829711 15.8145425305294 25.2822760245013 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89 15.5099956829711 15.8145425305294 25.2822760245013 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90 15.5014371780236 15.7744980008058 25.2823446966981 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91 15.459681324352 15.7418549288367 25.2823501534742 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92 15.4952510865558 15.7863042056356 25.2823633180108 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93 15.4894333680145 15.7692724247296 25.2823729393679 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94 15.4894333680145 15.7692724247296 25.2823729393679 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 15.497160986466 15.784416356866 25.2823738601726 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96 15.5010048128956 15.7863183379813 25.2823758721389 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97 15.4942566106739 15.7773159990925 25.2823765858442 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98 15.4942566106739 15.7773159990925 25.2823765858442 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99 15.4942566106739 15.7773159990925 25.2823765858442 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 15.4956590365794 15.7796905716934 25.2823767093344 contract outside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101 15.4956590365794 15.7796905716934 25.2823767093344 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102 15.4956590365794 15.7796905716934 25.2823767093344 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103 15.4957155413331 15.779422678147 25.2823767239752 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104 15.4957155413331 15.779422678147 25.2823767239752 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105 15.4957155413331 15.779422678147 25.2823767239752 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106 15.4959900024837 15.7798135534044 25.2823767246439 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107 15.4958325900067 15.7796667883301 25.2823767251057 contract inside </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization has terminated successfully. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum likelihood parameter estimates: lambda0: 15.495833, mu0: 15.779667, lambda1: 0.000000, mu1: 0.000000: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Maximum loglikelihood: 25.282377</span>
<span class="r-in"><span><span class="va">intGuessLamba</span> <span class="op">&lt;-</span> <span class="va">startingpoint</span><span class="op">$</span><span class="va">lambda0</span></span></span>
<span class="r-in"><span><span class="va">intGuessMu</span> <span class="op">&lt;-</span> <span class="va">startingpoint</span><span class="op">$</span><span class="va">mu0</span></span></span>
<span class="r-in"><span><span class="va">idparsopt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">initparsopt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">intGuessLamba</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">(</span><span class="va">intGuessLamba</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idparsfix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">parsfix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-02</span>, <span class="fl">1e-03</span>, <span class="fl">1e-03</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">maxiter</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idparsopt</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">optimmethod</span> <span class="op">&lt;-</span> <span class="st">'simplex'</span></span></span>
<span class="r-in"><span><span class="va">cond</span> <span class="op">&lt;-</span> <span class="st">'proper_cond'</span></span></span>
<span class="r-in"><span><span class="va">root_state_weight</span> <span class="op">&lt;-</span> <span class="st">'proper_weights'</span></span></span>
<span class="r-in"><span><span class="va">sampling_fraction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">&lt;-</span><span class="fu">secsse_ml</span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="va">phylotree</span>,</span></span>
<span class="r-in"><span><span class="va">traits</span>,</span></span>
<span class="r-in"><span><span class="va">num_concealed_states</span>,</span></span>
<span class="r-in"><span><span class="va">idparslist</span>,</span></span>
<span class="r-in"><span><span class="va">idparsopt</span>,</span></span>
<span class="r-in"><span><span class="va">initparsopt</span>,</span></span>
<span class="r-in"><span><span class="va">idparsfix</span>,</span></span>
<span class="r-in"><span><span class="va">parsfix</span>,</span></span>
<span class="r-in"><span><span class="va">cond</span>,</span></span>
<span class="r-in"><span><span class="va">root_state_weight</span>,</span></span>
<span class="r-in"><span><span class="va">sampling_fraction</span>,</span></span>
<span class="r-in"><span><span class="va">tol</span>,</span></span>
<span class="r-in"><span><span class="va">maxiter</span>,</span></span>
<span class="r-in"><span><span class="va">optimmethod</span>,</span></span>
<span class="r-in"><span>num_cycles <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: you set some transitions as impossible to happen.</span>
<span class="r-in"><span><span class="co"># model$ML</span></span></span>
<span class="r-in"><span><span class="co"># [1] -16.47099</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leonel Herrera Alsina, Paul van Els, Rampal S. Etienne.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

